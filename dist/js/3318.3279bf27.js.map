{"version":3,"file":"js/3318.3279bf27.js","mappings":"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","sources":["webpack://spotter/./src/graphql/documents/userDocuments.ts","webpack://spotter/./src/users/views/facilities/Reviews.vue?1baf","webpack://spotter/./src/users/views/facilities/Reviews.vue"],"sourcesContent":["import gql from \"graphql-tag\";\n\nexport const UserDocument = gql`\n  query user($id: ID!, $email: String) {\n    user(id: $id, email: $email) {\n      id\n      email\n      gender\n      created_at\n      updated_at\n    }\n  }\n`;\n\nexport const FollowTrainerDocument = gql`\n  mutation FollowTrainer($trainer_id: ID!) {\n    followTrainer(input: { trainer_id: $trainer_id }) {\n      id\n    }\n  }\n`;\n\nexport const UnfollowTrainerDocument = gql`\n  mutation UnfollowTrainer($trainer_id: ID!) {\n    unfollowTrainer(input: { trainer_id: $trainer_id }) {\n      id\n    }\n  }\n`;\n\nexport const GetTrainerDocument = gql`\n  query user($id: ID!) {\n    user(id: $id) {\n      id\n      first_name\n      last_name\n      avatar\n      score\n      avatarUrl\n      facilities {\n        address {\n          street\n        }\n      }\n      settings {\n        setting {\n          code\n        }\n        value\n      }\n    }\n  }\n`;\n\nexport const GetFacilityDocument = gql`\n  query Facility($id: ID!) {\n    facility(id: $id) {\n      was_commented_by_me\n      was_visited_by_me\n      address {\n        lat\n        lng\n        street\n      }\n      created_at\n      equipments {\n        name\n        id\n        icon\n        iconUrl\n      }\n      id\n      is_followed\n      media {\n        path\n        pathUrl\n      }\n      name\n      score\n      description\n      not_recommended_count\n      recommended_count\n      reviews_count\n      positive_reviews_count\n      negative_reviews_count\n      amenities {\n        id\n        name\n        icon\n        iconUrl\n      }\n    }\n  }\n`;\n\nexport const RefreshTokenDocument = gql`\n  mutation RefreshToken($refresh_token: String) {\n    refreshToken(input: { refresh_token: $refresh_token }) {\n      access_token\n      refresh_token\n      expires_in\n      token_type\n    }\n  }\n`;\n","import { defineComponent as _defineComponent } from 'vue'\nimport { createVNode as _createVNode, unref as _unref, resolveComponent as _resolveComponent, openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, createTextVNode as _createTextVNode, withCtx as _withCtx, renderList as _renderList, Fragment as _Fragment, createElementBlock as _createElementBlock, createSlots as _createSlots, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-80fd9cf2\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = { class: \"rating ion-padding-horizontal\" }\nconst _hoisted_2 = { class: \"rating-star\" }\nconst _hoisted_3 = { class: \"rating-star__title\" }\nconst _hoisted_4 = { class: \"tabs-holder\" }\nconst _hoisted_5 = { class: \"content ion-padding-horizontal\" }\nconst _hoisted_6 = { key: 1 }\n\nimport { IonButton } from \"@ionic/vue\";\nimport { Review as UserReview } from \"@/ts/types/user\";\nimport PageHeader from \"@/general/components/blocks/headers/PageHeader.vue\";\nimport StarRating from \"@/users/components/StarRating.vue\";\nimport LikeRating from \"@/users/components/LikeRating.vue\";\nimport BaseLayout from \"@/general/components/base/BaseLayout.vue\";\nimport PageTabs from \"@/general/components/PageTabs.vue\";\nimport ReviewItem from \"@/general/components/blocks/ratings/ReviewItem.vue\";\nimport GymFixed from \"@/general/components/blocks/GymFixed.vue\";\nimport { IonText } from \"@ionic/vue\";\nimport { ref, computed, onMounted } from \"vue\";\nimport { TabItem } from \"@/interfaces/TabItem\";\nimport { EntitiesEnum } from \"@/const/entities\";\nimport router from \"@/router\";\nimport { useQuery } from \"@vue/apollo-composable\";\nimport {\n  FeedbackEntityEnum,\n  Query,\n  Review,\n  ReviewsDocument,\n  ReviewTypeEnum,\n} from \"@/generated/graphql\";\nimport { useRoute } from \"vue-router\";\nimport { GetFacilityDocument } from \"@/graphql/documents/userDocuments\";\n\n\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'Reviews',\n  setup(__props) {\n\nconst route = useRoute();\n\nconst tabs: TabItem[] = [\n  {\n    name: ReviewTypeEnum.Recent,\n    label: \"Recent\",\n  },\n  {\n    name: ReviewTypeEnum.Positive,\n    label: \"Positive\",\n  },\n  {\n    name: ReviewTypeEnum.Negative,\n    label: \"Negative\",\n  },\n];\n\nconst activeTab = ref<ReviewTypeEnum>(ReviewTypeEnum.Recent);\n\nconst tabsChanged = (newTab: ReviewTypeEnum) => {\n  activeTab.value = newTab;\n};\n\nconst onAddReview = () => {\n  router.push({\n    name: EntitiesEnum.WriteReview,\n    params: { id: route.params.id },\n  });\n};\n\nconst handleBack = () => {\n  router.go(-1);\n};\n\nconst {\n  result: reviewsResult,\n  loading: reviewLoading,\n  refetch,\n} = useQuery(ReviewsDocument, () => ({\n  id: route.params.id,\n  type: FeedbackEntityEnum.Facility,\n  review_type: activeTab.value,\n}));\n\nonMounted(() => {\n  refetch();\n});\n\nconst reviews = computed(() =>\n  reviewsResult?.value?.reviews?.data.reduce(\n    (acc: UserReview[], cur: Review) => {\n      acc.push({\n        id: cur.id,\n        date: cur.created_at,\n        rating: cur.score || 0,\n        text: cur.review,\n        avatarUrl: cur.author?.avatarUrl || \"\",\n        fullName: `${cur.author?.first_name} ${cur.author?.last_name}`,\n      });\n      return acc;\n    },\n    []\n  )\n);\n\nconst { result, loading } = useQuery<Pick<Query, \"facility\">>(\n  GetFacilityDocument,\n  {\n    id: route.params.id,\n  }\n);\n\nconst facility = computed(() => result.value?.facility);\n\nconst isAbleToAddReview = computed(\n  () =>\n    facility.value?.was_visited_by_me && !facility.value?.was_commented_by_me\n);\n\nconst progressValue = computed(() => {\n  if (\n    facility.value?.positive_reviews_count &&\n    facility.value?.negative_reviews_count &&\n    facility.value?.score\n  ) {\n    return (\n      ((facility.value?.positive_reviews_count +\n        facility.value?.negative_reviews_count) /\n        facility.value?.score) *\n      100\n    );\n  } else {\n    return 0;\n  }\n});\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_ion_spinner = _resolveComponent(\"ion-spinner\")!\n\n  return (_openBlock(), _createBlock(BaseLayout, null, {\n    header: _withCtx(() => [\n      _createVNode(PageHeader, {\n        onBack: handleBack,\n        \"back-btn\": \"\",\n        title: \"Reviews\"\n      })\n    ]),\n    content: _withCtx(() => [\n      (_unref(loading))\n        ? (_openBlock(), _createBlock(_component_ion_spinner, {\n            key: 0,\n            name: \"lines\",\n            class: \"spinner\"\n          }))\n        : (_openBlock(), _createElementBlock(_Fragment, { key: 1 }, [\n            _createElementVNode(\"div\", _hoisted_1, [\n              _createElementVNode(\"div\", _hoisted_2, [\n                _createElementVNode(\"span\", _hoisted_3, _toDisplayString(facility.value?.score), 1),\n                _createVNode(StarRating, {\n                  \"model-value\": facility.value?.score || 0,\n                  size: \"medium\"\n                }, null, 8, [\"model-value\"]),\n                _createVNode(_unref(IonText), {\n                  color: \"medium\",\n                  class: \"rating-star__reviews\"\n                }, {\n                  default: _withCtx(() => [\n                    _createTextVNode(\" based on \" + _toDisplayString(facility.value?.reviews_count) + \" reviews \", 1)\n                  ]),\n                  _: 1\n                })\n              ]),\n              _createVNode(LikeRating, {\n                likes: facility.value?.positive_reviews_count || 0,\n                total: facility.value?.reviews_count || 0,\n                dislikes: facility.value?.negative_reviews_count || 0,\n                progressValue: progressValue.value\n              }, null, 8, [\"likes\", \"total\", \"dislikes\", \"progressValue\"])\n            ]),\n            _createElementVNode(\"div\", _hoisted_4, [\n              _createVNode(PageTabs, {\n                tabs: tabs,\n                class: \"page-tabs ion-padding-horizontal\",\n                value: activeTab.value,\n                onChange: tabsChanged\n              }, null, 8, [\"value\"]),\n              _createElementVNode(\"div\", _hoisted_5, [\n                (_unref(reviewLoading))\n                  ? (_openBlock(), _createBlock(_component_ion_spinner, {\n                      key: 0,\n                      name: \"lines\",\n                      class: \"spinner\"\n                    }))\n                  : (_openBlock(), _createElementBlock(\"div\", _hoisted_6, [\n                      (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(reviews.value, (review) => {\n                        return (_openBlock(), _createBlock(ReviewItem, {\n                          key: review.id,\n                          class: \"review-item\",\n                          \"avatar-url\": review.avatarUrl,\n                          \"full-name\": review.fullName,\n                          date: review.date,\n                          rating: review.rating,\n                          text: review.text\n                        }, null, 8, [\"avatar-url\", \"full-name\", \"date\", \"rating\", \"text\"]))\n                      }), 128))\n                    ]))\n              ])\n            ])\n          ], 64))\n    ]),\n    footer: _withCtx(() => [\n      _createVNode(GymFixed, {\n        title: facility.value?.name || '',\n        location: facility.value?.address?.street || ''\n      }, _createSlots({ _: 2 }, [\n        (isAbleToAddReview.value)\n          ? {\n              name: \"button\",\n              fn: _withCtx(() => [\n                _createVNode(_unref(IonButton), {\n                  expand: \"block\",\n                  color: \"primary\",\n                  class: \"fixed-holder__button\",\n                  onClick: onAddReview\n                }, {\n                  default: _withCtx(() => [\n                    _createTextVNode(\" Add review \")\n                  ]),\n                  _: 1\n                })\n              ]),\n              key: \"0\"\n            }\n          : undefined\n      ]), 1032, [\"title\", \"location\"])\n    ]),\n    _: 1\n  }))\n}\n}\n\n})","import script from \"./Reviews.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./Reviews.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./Reviews.vue?vue&type=style&index=0&id=80fd9cf2&scoped=true&lang=scss\"\n\nimport exportComponent from \"../../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-80fd9cf2\"]])\n\nexport default __exports__"],"names":["gql","GetTrainerDocument","GetFacilityDocument","_hoisted_1","class","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_6","key","_defineComponent","__name","setup","__props","route","useRoute","tabs","name","ReviewTypeEnum","Recent","label","Positive","Negative","activeTab","ref","tabsChanged","newTab","value","onAddReview","router","push","EntitiesEnum","WriteReview","params","id","handleBack","go","result","reviewsResult","loading","reviewLoading","refetch","useQuery","ReviewsDocument","type","FeedbackEntityEnum","Facility","review_type","onMounted","reviews","computed","data","reduce","acc","cur","date","created_at","rating","score","text","review","avatarUrl","author","fullName","first_name","last_name","facility","isAbleToAddReview","was_visited_by_me","was_commented_by_me","progressValue","positive_reviews_count","negative_reviews_count","_ctx","_cache","_component_ion_spinner","_resolveComponent","_openBlock","_createBlock","BaseLayout","header","_withCtx","_createVNode","PageHeader","onBack","title","content","_unref","_createElementBlock","_Fragment","_createElementVNode","_toDisplayString","StarRating","size","IonText","color","default","_createTextVNode","reviews_count","_","LikeRating","likes","total","dislikes","PageTabs","onChange","_renderList","ReviewItem","footer","GymFixed","location","address","street","_createSlots","fn","IonButton","expand","onClick","undefined","__exports__"],"sourceRoot":""}