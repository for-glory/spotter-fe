{"version":3,"file":"js/1428.901054a6.js","mappings":"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","sources":["webpack://spotter/./src/facilities/components/ChooseFacilityModal.vue?5960","webpack://spotter/./src/facilities/components/ChooseFacilityModal.vue","webpack://spotter/./src/facilities/views/registration/SelectExistingFacility.vue?7ce9","webpack://spotter/./src/facilities/views/registration/SelectExistingFacility.vue"],"sourcesContent":["import { defineComponent as _defineComponent } from 'vue'\nimport { unref as _unref, createVNode as _createVNode, withCtx as _withCtx, openBlock as _openBlock, createBlock as _createBlock } from \"vue\"\n\nimport { IonModal } from \"@ionic/vue\";\nimport { ref } from \"vue\";\nimport {\n  SelectFacilityModalOptions,\n  SelectFacilityModalResult,\n} from \"@/interfaces/SelectFacilityModal\";\nimport { FacilitiesTrainersTabs } from \"@/ts/enums/user\";\nimport SearchForm from \"@/general/components/forms/SearchForm.vue\";\nimport { Facility } from \"@/generated/graphql\";\n\n\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'ChooseFacilityModal',\n  emits: [\"cancel\", \"select\"],\n  setup(__props, { expose: __expose, emit: emits }) {\n\nconst modal = ref<typeof IonModal | null>(null);\nconst searchForm = ref<typeof SearchForm | null>(null);\nconst selected = ref<Facility | null | undefined>(null);\nconst searchFilters = ref<any | null>(null);\n\n\n\nconst cancel = () => {\n  emits(\"cancel\");\n  resetAndClose();\n};\n\nconst present = (props: SelectFacilityModalOptions) => {\n  searchFilters.value = props.filters;\n  modal?.value?.$el.present();\n  selected.value = props.selected;\n  searchForm.value?.$el.search();\n};\n\nconst resetAndClose = () => {\n  modal?.value?.$el.dismiss();\n};\n\n__expose({\n  present,\n});\n\nconst onItemClick = (facility: Facility) => {\n  emits(\"select\", { facility });\n  resetAndClose();\n};\n\nreturn (_ctx: any,_cache: any) => {\n  return (_openBlock(), _createBlock(_unref(IonModal), {\n    ref_key: \"modal\",\n    ref: modal\n  }, {\n    default: _withCtx(() => [\n      _createVNode(SearchForm, {\n        \"back-btn\": \"\",\n        \"hidden-cancel\": \"\",\n        \"visible-result\": \"\",\n        onBack: cancel,\n        ref_key: \"searchForm\",\n        ref: searchForm,\n        customNavigation: \"\",\n        filters: searchFilters.value,\n        onHandleItemClick: onItemClick,\n        type: _unref(FacilitiesTrainersTabs).Facilities,\n        placeholder: \"Enter name or address of gym...\",\n        \"no-found-msg\": \"No results found. Check selected state/city.\"\n      }, null, 8, [\"filters\", \"type\"])\n    ]),\n    _: 1\n  }, 512))\n}\n}\n\n})","import script from \"./ChooseFacilityModal.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./ChooseFacilityModal.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./ChooseFacilityModal.vue?vue&type=style&index=0&id=0d0076a2&scoped=true&lang=scss\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-0d0076a2\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue'\nimport { createVNode as _createVNode, unref as _unref, createElementVNode as _createElementVNode, createTextVNode as _createTextVNode, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, createBlock as _createBlock, withCtx as _withCtx, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-4a287c4d\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = { class: \"content\" }\nconst _hoisted_2 = { class: \"main\" }\nconst _hoisted_3 = { class: \"form-row\" }\nconst _hoisted_4 = { class: \"buttons\" }\n\nimport { IonButton, IonSpinner } from \"@ionic/vue\";\nimport PageHeader from \"@/general/components/blocks/headers/PageHeader.vue\";\nimport BaseLayout from \"@/general/components/base/BaseLayout.vue\";\nimport { useRouter } from \"vue-router\";\nimport { ref } from \"vue\";\nimport ChooseAddressModal from \"@/general/components/ChooseAddressModal.vue\";\nimport ChooseFacilityModal from \"@/facilities/components/ChooseFacilityModal.vue\";\nimport ChooseBlock from \"@/general/components/blocks/Choose.vue\";\nimport {\n  City,\n  Facility,\n  State,\n  AttachToFacilityDocument,\n  UpdateUserSettingsDocument,\n} from \"@/generated/graphql\";\nimport { EntitiesEnum } from \"@/const/entities\";\nimport { ChooseAddresModalResult } from \"@/interfaces/ChooseAddressModalOption\";\nimport { SelectFacilityModalResult } from \"@/interfaces/SelectFacilityModal\";\nimport { useMutation } from \"@vue/apollo-composable\";\nimport useId from \"@/hooks/useId\";\nimport { ProfileSettings } from \"@/ts/enums/user\";\nimport { setSettings } from \"@/hooks/useSettings\";\n\n\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'SelectExistingFacility',\n  setup(__props) {\n\nconst router = useRouter();\n\nconst onBack = () => {\n  router.go(-1);\n};\n\nconst chooseAddressModal = ref<typeof ChooseAddressModal | null>(null);\nconst selectedState = ref<State | null>(null);\nconst selectedCity = ref<City | null>(null);\nconst selectedFacility = ref<Facility | null>(null);\n\nconst chooseState = () => {\n  chooseAddressModal.value?.present({\n    type: EntitiesEnum.State,\n    title: \"Select state\",\n    selected: selectedState.value?.id,\n  });\n};\n\nconst chooseCity = () => {\n  chooseAddressModal.value?.present({\n    type: EntitiesEnum.City,\n    title: \"Select city\",\n    selected: selectedCity.value?.id,\n    state: selectedState.value,\n  });\n};\n\nconst addressSelected = async (selected: ChooseAddresModalResult) => {\n  if (!selected) return;\n  selectedState.value = selected.state;\n  selectedCity.value = selected.city;\n};\n\nconst {\n  mutate: attachToFacility,\n  onDone: attachedToFacility,\n  loading,\n} = useMutation(AttachToFacilityDocument);\n\nconst selectFacility = () => {\n  const { registration_code } = JSON.parse(\n    localStorage.getItem(\"organization\") || \"{}\"\n  );\n  if (!registration_code) {\n    router.push({\n      name: EntitiesEnum.EnterCode,\n    });\n    return;\n  }\n  attachToFacility({\n    input: {\n      registration_code,\n      facility_id: selectedFacility.value?.id,\n    },\n  });\n};\n\nattachedToFacility(() => {\n  updateSettings();\n});\n\nconst {\n  mutate: updateUserSettings,\n  onDone: settingsUpdated,\n  loading: settingsOnUpdate,\n} = useMutation(UpdateUserSettingsDocument);\n\nconst updateSettings = () => {\n  setSettings([{ isFacilitySetUp: true }]);\n  const { id } = useId();\n\n  const front_settings = localStorage.getItem(ProfileSettings.UserSettings);\n\n  updateUserSettings({\n    id,\n    front_settings,\n  });\n};\n\nsettingsUpdated(() => {\n  localStorage.removeItem(\"organization\");\n  router.push({\n    name: EntitiesEnum.Profile,\n  });\n});\n\nconst chooseFacilityModal = ref<typeof ChooseFacilityModal | null>(null);\n\nconst chooseGyms = () => {\n  const { id: organization_id } = JSON.parse(\n    localStorage.getItem(\"organization\") || \"{}\"\n  );\n  if (!organization_id) return;\n  chooseFacilityModal.value?.present({\n    filters: {\n      organization_id,\n      city_id: selectedCity.value?.id,\n      state_id: selectedState.value?.id,\n    },\n    selected: selectedFacility.value,\n  });\n};\n\nconst facilitySelected = (data: SelectFacilityModalResult) => {\n  selectedFacility.value = data.facility;\n};\n\nreturn (_ctx: any,_cache: any) => {\n  return (_openBlock(), _createElementBlock(_Fragment, null, [\n    _createVNode(BaseLayout, { \"hide-navigation-menu\": \"\" }, {\n      header: _withCtx(() => [\n        _createVNode(PageHeader, {\n          \"back-btn\": \"\",\n          title: \"Location\",\n          onBack: onBack\n        })\n      ]),\n      content: _withCtx(() => [\n        _createElementVNode(\"div\", _hoisted_1, [\n          _createElementVNode(\"div\", _hoisted_2, [\n            _createElementVNode(\"div\", _hoisted_3, [\n              _createVNode(ChooseBlock, {\n                title: \"State\",\n                class: \"form-row__control\",\n                onHandleClick: chooseState,\n                value: selectedState.value?.name,\n                disabled: _unref(loading) || _unref(settingsOnUpdate)\n              }, null, 8, [\"value\", \"disabled\"]),\n              _createVNode(ChooseBlock, {\n                title: \"City\",\n                class: \"form-row__control\",\n                onHandleClick: chooseCity,\n                value: selectedCity.value?.name,\n                disabled: !selectedState.value || _unref(loading) || _unref(settingsOnUpdate)\n              }, null, 8, [\"value\", \"disabled\"]),\n              _createVNode(ChooseBlock, {\n                title: \"Gyms\",\n                class: \"form-row__control\",\n                onHandleClick: chooseGyms,\n                value: selectedFacility.value?.name || '',\n                disabled: !selectedCity.value || _unref(loading) || _unref(settingsOnUpdate)\n              }, null, 8, [\"value\", \"disabled\"])\n            ])\n          ]),\n          _createElementVNode(\"div\", _hoisted_4, [\n            _createVNode(_unref(IonButton), {\n              expand: \"block\",\n              onClick: selectFacility,\n              disabled: !selectedFacility.value || _unref(loading) || _unref(settingsOnUpdate)\n            }, {\n              default: _withCtx(() => [\n                (!_unref(loading) && !_unref(settingsOnUpdate))\n                  ? (_openBlock(), _createElementBlock(_Fragment, { key: 0 }, [\n                      _createTextVNode(\"Submit and finish\")\n                    ], 64))\n                  : (_openBlock(), _createBlock(_unref(IonSpinner), {\n                      key: 1,\n                      name: \"lines\",\n                      class: \"spinner\"\n                    }))\n              ]),\n              _: 1\n            }, 8, [\"disabled\"])\n          ])\n        ])\n      ]),\n      _: 1\n    }),\n    _createVNode(ChooseAddressModal, {\n      ref_key: \"chooseAddressModal\",\n      ref: chooseAddressModal,\n      onSelect: addressSelected\n    }, null, 512),\n    _createVNode(ChooseFacilityModal, {\n      ref_key: \"chooseFacilityModal\",\n      ref: chooseFacilityModal,\n      onSelect: facilitySelected\n    }, null, 512)\n  ], 64))\n}\n}\n\n})","import script from \"./SelectExistingFacility.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./SelectExistingFacility.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./SelectExistingFacility.vue?vue&type=style&index=0&id=4a287c4d&scoped=true&lang=scss\"\n\nimport exportComponent from \"../../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-4a287c4d\"]])\n\nexport default __exports__"],"names":["_defineComponent","__name","emits","setup","__props","expose","__expose","emit","modal","ref","searchForm","selected","searchFilters","cancel","resetAndClose","present","props","value","filters","$el","search","dismiss","onItemClick","facility","_ctx","_cache","_openBlock","_createBlock","_unref","IonModal","ref_key","default","_withCtx","_createVNode","SearchForm","onBack","customNavigation","onHandleItemClick","type","FacilitiesTrainersTabs","Facilities","placeholder","_","__exports__","_hoisted_1","class","_hoisted_2","_hoisted_3","_hoisted_4","router","useRouter","go","chooseAddressModal","selectedState","selectedCity","selectedFacility","chooseState","EntitiesEnum","State","title","id","chooseCity","City","state","addressSelected","async","city","mutate","attachToFacility","onDone","attachedToFacility","loading","useMutation","AttachToFacilityDocument","selectFacility","registration_code","JSON","parse","localStorage","getItem","input","facility_id","push","name","EnterCode","updateSettings","updateUserSettings","settingsUpdated","settingsOnUpdate","UpdateUserSettingsDocument","setSettings","isFacilitySetUp","useId","front_settings","ProfileSettings","UserSettings","removeItem","Profile","chooseFacilityModal","chooseGyms","organization_id","city_id","state_id","facilitySelected","data","_createElementBlock","_Fragment","BaseLayout","header","PageHeader","content","_createElementVNode","ChooseBlock","onHandleClick","disabled","IonButton","expand","onClick","IonSpinner","key","_createTextVNode","ChooseAddressModal","onSelect","ChooseFacilityModal"],"sourceRoot":""}