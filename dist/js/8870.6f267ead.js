"use strict";(self["webpackChunkspotter"]=self["webpackChunkspotter"]||[]).push([[8870],{21978:function(e,a,l){l.r(a),l.d(a,{default:function(){return A}});l(57658);var i=l(66252),t=l(2262),o=l(3577),v=l(31810),r=l(12954),u=l(22201),s=l(25934),n=l(75333),d=l(17343),c=l(61081),p=l(55373),m=l(16025),h=l(87794),_=l(49316),U=l(78022),g=l(67273);const P={class:"exercise-form-content"},f={class:"form-row"},w={class:"form-row"},E={class:"form-row"},x={class:"form-row"},b={class:"exercise-action-wrap"};var k=(0,i.aZ)({__name:"Exercise",setup(e){const a=(0,u.tv)(),l=(0,u.yj)(),k=(0,d.y)(),S=(0,t.iH)(""),H=(0,t.iH)(!1),A=(0,t.iH)(0),z=(0,t.iH)(""),C=(0,t.iH)(""),N=(0,t.iH)(!1),y=(0,t.iH)(!1),L=(0,t.iH)(""),D=(0,t.iH)(""),W=(0,t.iH)(),I=(0,t.iH)({name:"",size:""});(0,i.YP)((()=>l.params.id),(e=>{J(e.toString())}));const{value:T,errorMessage:Z}=(0,r.U$)("exerciseTitle"),V=async()=>{k.setExercise({title:T.value,description:S.value,videoPath:D.value,previewUrl:z.value,previewPath:C.value,path:L.value,id:l.params.id,videoSize:I.value.size,videoName:I.value.name})},q=()=>{V(),T.value="",D.value="",S.value="",z.value="",A.value++,a.push({name:c.N.TrainerCreateExercise,params:{id:(0,s.Z)()}})},O=(0,i.Fl)((()=>T.value&&z.value&&D.value)),$=async e=>{if(!e?.length)return void Y();const a=(0,m.U)(e,(0,s.Z)());N.value=!0,W.value=0,await M({file:a}).then((e=>{C.value=e?.data.filePreload.path,z.value=`${{NODE_ENV:"production",VUE_APP_API_URL:"https://api.spotterfitness.com/graphql",VUE_APP_GOOGLE_AUTH_CLIENT_ID:"",BASE_URL:"/"}.VUE_APP_MEDIA_URL}${e?.data.filePreload.path}`,N.value=!1,W.value=void 0})).catch((e=>{console.error(e),R(),N.value=!1,W.value=void 0}))},G=async(e,a,l)=>{y.value=!0,W.value=0,await M({file:e}).then((e=>{L.value=e?.data.filePreload.path,D.value=`${{NODE_ENV:"production",VUE_APP_API_URL:"https://api.spotterfitness.com/graphql",VUE_APP_GOOGLE_AUTH_CLIENT_ID:"",BASE_URL:"/"}.VUE_APP_MEDIA_URL}${e?.data.filePreload.path}`,y.value=!1,W.value=void 0,I.value.size=a,I.value.name=l})).catch((e=>{R(),console.error(e),L.value="",D.value="",y.value=!1,W.value=void 0,I.value.size="",I.value.name=""}))};let R;const{mutate:M}=(0,_.Db)(h.nu,{context:{fetchOptions:{useUpload:!0,onProgress:e=>{W.value=e.loaded/e.total*100},onAbortPossible:e=>{R=e}}}}),Y=()=>{z.value=""},B=()=>{D.value=""},j=()=>{ee.value?ae():V(),k.setMedia(),O.value&&(ee.value?a.go(-1):a.push({name:c.N.TrainerExerciseList}))},F=e=>{H.value=!1,e&&(k.exercises[l.params.id.toString()]&&k.removeExercise(l.params.id.toString()),a.go(-1))},Q=()=>{!ee.value&&(D.value||T.value||S.value)?H.value=!0:a.go(-1)},J=e=>{const a=k.exercises[e];a&&(T.value=a.title,D.value=a.videoPath,z.value=a.previewUrl,C.value=a.previewPath,S.value=a.description||"",I.value={size:a?.videoSize||"",name:a?.videoName||""})},K=l.params.id;K&&J(K.toString());const X=(0,t.iH)(l.params.id?String(l.params.id):null),ee=(0,t.iH)(Boolean(l.query["edit"]));if(ee.value&&X.value){const e=k.exercises[X.value];T.value=e.title,S.value=e.description||"",D.value=e.videoPath,z.value=e.previewUrl,C.value=e.previewPath,L.value=e.path,I.value={size:e.videoSize,name:e.videoName}}const ae=()=>{k.editExercise(X.value,{title:T.value,description:S.value,videoPath:D.value,previewUrl:z.value,previewPath:C.value,path:L.value,id:l.params.id,videoSize:I.value.size,videoName:I.value.name})};return(e,a)=>{const l=(0,i.up)("page-header"),r=(0,i.up)("base-layout");return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i.Wm)(r,{hideNavigationMenu:""},{header:(0,i.w5)((()=>[(0,i.Wm)(l,{onBack:Q,"back-btn":"",title:"Create exercise"})])),content:(0,i.w5)((()=>[(0,i._)("div",P,[(0,i._)("div",f,[(0,i.Wm)((0,t.SU)(v.Q$),{class:"label"},{default:(0,i.w5)((()=>[(0,i.Uk)(" Choose exercise cover ")])),_:1}),(0,i.Wm)(U.Z,{photo:z.value,onChange:$,progress:W.value,loading:N.value},null,8,["photo","progress","loading"])]),(0,i._)("div",w,[(0,i.Wm)((0,t.SU)(v.Q$),{class:"label"},{default:(0,i.w5)((()=>[(0,i.Uk)(" Choose video for "),0===A.value?((0,i.wg)(),(0,i.iD)(i.HY,{key:0},[(0,i.Uk)("first")],64)):(0,i.kq)("",!0),(0,i.Uk)(" exercise ")])),_:1}),(0,i.Wm)(p.Z,{video:D.value,onDelete:B,onChange:G,loading:y.value,"video-size":I.value.size,"video-name":I.value.name,"button-text":"Upload exercise",loadingPercent:W.value},null,8,["video","loading","video-size","video-name","loadingPercent"])]),(0,i._)("div",E,[(0,i.Wm)(g.Z,{value:(0,t.SU)(T),"onUpdate:value":a[0]||(a[0]=e=>(0,t.dq)(T)?T.value=e:null),"error-message":(0,t.SU)(Z),placeholder:"Enter title",name:"exerciseTitle",label:"Create short title for video",required:""},null,8,["value","error-message"])]),(0,i._)("div",x,[(0,i.Wm)(g.Z,{"auto-grow":"",value:S.value,"onUpdate:value":a[1]||(a[1]=e=>S.value=e),"error-message":(0,t.SU)(Z),placeholder:"Enter instruction tips",name:"exerciseTitle",label:"Create instruction tip for video",rows:3},null,8,["value","error-message"])]),(0,i._)("div",b,[ee.value?(0,i.kq)("",!0):((0,i.wg)(),(0,i.j4)((0,t.SU)(v.YG),{key:0,onClick:q,type:"submit",expand:"block",disabled:!O.value},{default:(0,i.w5)((()=>[(0,i.Uk)(" Add next exercise ")])),_:1},8,["disabled"])),(0,i.Wm)((0,t.SU)(v.YG),{onClick:j,type:"submit",expand:"block",class:"secondary",disabled:!O.value},{default:(0,i.w5)((()=>[(0,i.Uk)((0,o.zw)(ee.value?"Save exercise":"Finish workout"),1)])),_:1},8,["disabled"])])])])),_:1}),(0,i.Wm)(n.Z,{"is-open":H.value,onClose:F},null,8,["is-open"])],64)}}}),S=l(83744);const H=(0,S.Z)(k,[["__scopeId","data-v-2d47c0af"]]);var A=H}}]);
//# sourceMappingURL=8870.6f267ead.js.map