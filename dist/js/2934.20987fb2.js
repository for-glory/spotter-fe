"use strict";(self["webpackChunkspotter"]=self["webpackChunkspotter"]||[]).push([[2934],{95267:function(e,t,s){s.d(t,{d:function(){return o}});s(57658);var a=s(26089);const o=(0,a.Q_)("new-facility",{state:()=>({photos:[],title:"",description:"",address:{state:null,city:null,address:null},equipments:[],amenities:[]}),actions:{addPhoto(e,t){t?this.photos[t]=e:this.photos.push(e)},deletePhoto(e){this.photos.splice(e,1)},setTitle(e){this.title=e},setDescription(e){this.description=e},setEquipments(e){this.equipments=e},setAmenities(e){this.amenities=e},setAddress(e,t,s){this.address={state:e,city:t,address:s}},clear(){this.photos=[],this.title="",this.description="",this.address={state:null,city:null,address:null},this.equipments=[],this.amenities=[]}},getters:{getEquipments:e=>e.equipments,getAmenities:e=>e.amenities}})},87394:function(e,t,s){s.d(t,{Z:function(){return A}});s(57658);var a=s(66252),o=s(3577),n=s(2262),l=s(31810),i=s(47209),d=s(61081),r=s(22201),c=s(37891),u=s(87794),m=s(25934),p=s(16025),_=s(49316),v=s(95267),h=s(65277);const g={class:"form-row"},f={class:"form-row"},y={class:"form-row"},w={class:"form-row"},b={class:"address-container"},k={class:"form-row"};var U=(0,a.aZ)({__name:"GymForm",props:{buttonText:{default:"Save"},previewButton:{type:Boolean},footerFixed:{type:Boolean},edit:{type:Boolean}},emits:["submit","on-delete-media"],setup(e,{expose:t,emit:s}){const U=e,{load:C,refetch:S}=(0,_.td)(u.Oo,{first:15,name:"",state_code:""});C();const A=(0,r.tv)(),W=(0,v.d)(),q=(0,a.Fl)((()=>W.photos)),x=(0,a.Fl)((()=>W.title)),D=e=>{W.setTitle(e)},Z=(0,a.Fl)((()=>W.description)),F=e=>{W.setDescription(e)},P=(0,a.Fl)((()=>W.equipments)),B=(0,a.Fl)((()=>W.amenities)),E=(0,n.iH)(null),$=e=>{W.setEquipments(e.equipments||[]),W.setAmenities(e.amenities||[])},z=(0,a.Fl)((()=>W.address.state)),N=(0,a.Fl)((()=>W.address.city)),H=(0,a.Fl)((()=>W.address.address)),I=()=>{E.value?.present({title:"Amenities",equipments:W.getEquipments.map((e=>e.id)),amenities:W.getAmenities.map((e=>e.id))})},G=(0,n.iH)(null),O=e=>{let t="",s="";const a={latitude:e.geometry.location.lat().toString(),longitude:e.geometry.location.lng().toString(),countryCode:"",countryName:"",postalCode:"",administrativeArea:"",subAdministrativeArea:"",locality:"",subLocality:"",thoroughfare:"",subThoroughfare:"",areasOfInterest:[]};for(let o=0;o<e.address_components.length;o++)e.address_components[o].types.includes("postal_code")&&(a.postalCode=e.address_components[o].long_name),e.address_components[o].types.includes("locality")&&(a.locality=e.address_components[o].long_name),e.address_components[o].types.includes("subLocality")&&(a.subLocality=e.address_components[o].long_name),e.address_components[o].types.includes("country")&&(a.countryName=e.address_components[o].long_name,a.countryCode=e.address_components[o].short_name),e.address_components[o].types.includes("administrative_area_level_1")&&(a.administrativeArea=e.address_components[o].short_name),e.address_components[o].types.includes("administrative_area_level_2")&&(a.subAdministrativeArea=e.address_components[o].long_name),e.address_components[o].types.includes("street_number")&&(t=e.address_components[o].long_name),e.address_components[o].types.includes("route")&&(s=e.address_components[o].long_name);return a.thoroughfare=t+" "+s,a},T=e=>{if(e){console.log("selected place",z.value,N.value,H.value);const t=O(e);t.locality&&S({first:15,name:t.locality,state_code:t.administrativeArea})?.then((async e=>{const s=e.data.cities.data[0];console.log("selected city",s),W.setAddress(s.state,s,t)}))}},L=e=>{W.setAddress(e.state,e.city,e.address)},M=(0,n.iH)(!1),Y=(0,n.iH)(),j=async(e,t)=>{const s=(0,p.U)(e,(0,m.Z)());M.value=!0,Y.value=0,await X({file:s}).then((e=>{W.addPhoto({path:e?.data.filePreload.path,url:`${{NODE_ENV:"production",BASE_URL:"/"}.VUE_APP_MEDIA_URL}${e?.data.filePreload.path}`},t),M.value=!1,Y.value=void 0})).catch((e=>{console.error(e),Q(),M.value=!1,Y.value=void 0}))};let Q;const{mutate:X}=(0,_.Db)(u.nu,{context:{fetchOptions:{useUpload:!0,onProgress:e=>{Y.value=e.loaded/e.total*100},onAbortPossible:e=>{Q=e}}}}),R=(e,t)=>{W.deletePhoto(e),U.edit&&t&&s("on-delete-media",t)},V=()=>{A.push({name:d.N.FacilityPreview})},J=()=>{console.log("selected address",z.value,N.value,H.value),s("submit",{title:x.value,description:Z.value,photos:q.value,address:{state:z.value,city:N.value,address:H.value},equipments:P.value,amenities:B.value})},K=()=>{W.clear()};return t({clearStore:K}),(e,t)=>{const s=(0,a.up)("base-input"),d=(0,a.up)("ion-text"),r=(0,a.up)("GMapAutocomplete"),u=(0,a.up)("choose-block");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a._)("div",{class:(0,o.C_)(["inputs-form",{"inputs-form--footer-fixed":e.footerFixed}])},[(0,a._)("div",g,[(0,a.Wm)((0,n.SU)(l.Q$),{class:"label"},{default:(0,a.w5)((()=>[(0,a.Uk)(" Choose photos for gym ")])),_:1}),(0,a.Wm)(i.Z,{onUpload:j,onDelete:R,onChange:j,"circle-shape":!1,photos:q.value,loading:M.value,progress:Y.value},null,8,["photos","loading","progress"])]),(0,a._)("div",f,[(0,a.Wm)(s,{required:"",onChange:D,value:x.value,"onUpdate:value":t[0]||(t[0]=e=>x.value=e),placeholder:"Enter title for gym",label:"Whatâ€™s the name of your gym"},null,8,["value"])]),(0,a._)("div",y,[(0,a.Wm)(s,{rows:3,maxlength:150,label:"Describe your gym",onChange:F,value:Z.value,"onUpdate:value":t[1]||(t[1]=e=>Z.value=e),placeholder:"Enter description for gym"},null,8,["value"])]),(0,a._)("div",w,[(0,a.Wm)((0,n.SU)(l.Q$),{class:"label"},{default:(0,a.w5)((()=>[(0,a.Uk)(" Choose your gym location ")])),_:1}),(0,a._)("div",b,[(0,a.Wm)(d,{class:"address-content"},{default:(0,a.w5)((()=>[(0,a.Uk)(" Address ")])),_:1}),H.value?.thoroughfare?((0,a.wg)(),(0,a.j4)(d,{key:0,class:"address-content"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(`${H.value?.thoroughfare} ${H.value?.subThoroughfare}`)+", "+(0,o.zw)(`${N.value?.name}`)+", "+(0,o.zw)(`${N.value?.state?.name}`),1)])),_:1})):(0,a.kq)("",!0)]),(0,a.Wm)(r,{placeholder:"Enter your address",class:(0,o.C_)(["search-form__control",{"search-form__control--on-focus":e.isFocused}]),onPlace_changed:T},null,8,["class"])]),(0,a._)("div",k,[(0,a.Wm)((0,n.SU)(l.Q$),{class:"label"},{default:(0,a.w5)((()=>[(0,a.Uk)(" Choose equipment and amenitites ")])),_:1}),(0,a.Wm)(u,{title:"Equipment and amenities",onHandleClick:I,value:P.value?.length+B.value?.length||""},null,8,["value"])]),(0,a._)("div",{class:(0,o.C_)(["actions-wrapper",{"actions-wrapper--fixed":e.footerFixed}])},[e.previewButton?((0,a.wg)(),(0,a.j4)((0,n.SU)(l.YG),{key:0,expand:"block",class:"secondary",onClick:V,disabled:!x.value?.length||!q.value?.length||!H.value},{default:(0,a.w5)((()=>[(0,a.Uk)(" Preview ")])),_:1},8,["disabled"])):(0,a.kq)("",!0),(0,a.Wm)((0,n.SU)(l.YG),{expand:"block",onClick:J,disabled:!x.value?.length||!q.value?.length||!H.value},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.buttonText),1)])),_:1},8,["disabled"])],2)],2),(0,a.Wm)(c.Z,{ref_key:"chooseAddressModal",ref:G,onSelect:L},null,512),(0,a.Wm)(h.Z,{ref_key:"equipmentAndAmenitiessModal",ref:E,onCancel:$},null,512)],64)}}}),C=s(83744);const S=(0,C.Z)(U,[["__scopeId","data-v-27bb06a6"]]);var A=S},46618:function(e,t,s){s.r(t),s.d(t,{default:function(){return b}});s(57658);var a=s(66252),o=s(2262),n=s(31810),l=s(10121),i=s(19239),d=s(87394),r=s(22201),c=s(75333),u=s(49316),m=s(87794),p=s(59205),_=s(19648),v=s(61081),h=s(43173);const g={class:"content"};var f=(0,a.aZ)({__name:"AddNewGym",setup(e){const t=(0,r.tv)(),s=(0,o.iH)(!1),f=()=>{s.value=!0},y=e=>{s.value=!1,e&&(A.value?.clearStore(),t.go(-1))},{mutate:w,onDone:b}=(0,u.Db)(m.ZX);b((()=>{A.value?.clearStore(),C()}));const{mutate:k,onDone:U}=(0,u.Db)(m.PO),C=()=>{(0,p.I2)([{isFacilitySetUp:!0}]);const{id:e}=(0,h.Z)(),t=localStorage.getItem(_.LX.UserSettings);k({id:e,front_settings:t})};U((()=>{localStorage.removeItem("organization"),t.push({name:v.N.Profile})}));const S=e=>{const{registration_code:t}=JSON.parse(localStorage.getItem("organization")||"{}");w({input:{name:e.title,description:e.description,address:{lat:Number(e.address.address?.latitude),lng:Number(e.address.address?.longitude),street:`${e.address.address?.thoroughfare||""}, ${e.address.address?.subThoroughfare||""}`,city_id:e.address.city?.id},media:e.photos.map(((t,s)=>({title:`${e.title}-${s}`,file:t.path}))),equipments:e.equipments.map((e=>e.id)),amenities:e.amenities.map((e=>e.id)),registration_code:t}}).then((async()=>{const e=await n.Mn.create({message:"New Gym was created successfully",duration:2e3,icon:"assets/icon/success.svg",cssClass:"success-toast"});e.present()})).catch((async e=>{const t=await n.Mn.create({message:"Something went wrong. Please try again.",icon:"assets/icon/info.svg",cssClass:"danger-toast"});throw t.present(),new Error(e)}))},A=(0,o.iH)(null);return(e,t)=>((0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)((0,o.SU)(n._i),{ref:"page"},{default:(0,a.w5)((()=>[(0,a.Wm)(l.Z,{"hide-navigation-menu":""},{header:(0,a.w5)((()=>[(0,a.Wm)(i.Z,{"back-btn":"",onBack:f,title:"Add new gym"})])),content:(0,a.w5)((()=>[(0,a._)("div",g,[(0,a.Wm)(d.Z,{ref_key:"gymForm",ref:A,"button-text":"Create",onSubmit:S},null,512)])])),_:1})])),_:1},512),(0,a.Wm)(c.Z,{"is-open":s.value,onClose:y,title:"Do you want to discard changes?",text:"Changes will not be saved",cancelButton:"Cancel",button:"Discard changes"},null,8,["is-open"])],64))}}),y=s(83744);const w=(0,y.Z)(f,[["__scopeId","data-v-6bf61df2"]]);var b=w},75333:function(e,t,s){s.d(t,{Z:function(){return _}});var a=s(66252),o=s(2262),n=s(3577),l=s(31810);const i={class:"wrapper"},d={class:"ion-padding-horizontal"},r={class:"modal__content"},c={class:"modal__footer"};var u=(0,a.aZ)({__name:"DiscardChanges",props:{isOpen:{type:Boolean},title:{default:"Do you want to discard changes?"},text:{default:"Changes will not be saved"},button:{default:"Discard changes"},cancelButton:{default:"Cancel"},hideButton:{type:Boolean}},emits:["close"],setup(e,{emit:t}){const s=e=>{t("close",Boolean(e))};return(e,t)=>((0,a.wg)(),(0,a.j4)((0,o.SU)(l.ki),{ref:"modal","is-open":e.isOpen,"backdrop-dismiss":!1},{default:(0,a.w5)((()=>[(0,a._)("div",i,[(0,a.Wm)((0,o.SU)(l.gu),{src:"assets/icon/close.svg",onClick:t[0]||(t[0]=e=>s()),class:"close-btn"}),(0,a.Wm)((0,o.SU)(l.Xz),{class:"modal__img",src:"assets/dumbbells.png"}),(0,a._)("div",d,[(0,a.Wm)((0,o.SU)(l.wd),{class:"modal__title"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,n.zw)(e.title),1)])),_:1}),(0,a._)("div",r,[(0,a.Wm)((0,o.SU)(l.yW),{color:"secondary",class:"modal__text"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,n.zw)(e.text),1)])),_:1})]),(0,a._)("div",c,[(0,a.Wm)((0,o.SU)(l.YG),{onClick:t[1]||(t[1]=e=>s()),class:"modal__button"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,n.zw)(e.cancelButton),1)])),_:1}),e.hideButton?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)((0,o.SU)(l.YG),{key:0,onClick:t[2]||(t[2]=e=>s(!0)),class:"modal__button secondary"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,n.zw)(e.button),1)])),_:1}))])])])])),_:1},8,["is-open"]))}}),m=s(83744);const p=(0,m.Z)(u,[["__scopeId","data-v-e8a157da"]]);var _=p}}]);
//# sourceMappingURL=2934.20987fb2.js.map