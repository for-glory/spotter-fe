"use strict";(self["webpackChunkspotter"]=self["webpackChunkspotter"]||[]).push([[9635],{95267:function(e,t,s){s.d(t,{d:function(){return o}});s(57658);var a=s(26089);const o=(0,a.Q_)("new-facility",{state:()=>({photos:[],title:"",description:"",address:{state:null,city:null,address:null},equipments:[],amenities:[]}),actions:{addPhoto(e,t){t?this.photos[t]=e:this.photos.push(e)},deletePhoto(e){this.photos.splice(e,1)},setTitle(e){this.title=e},setDescription(e){this.description=e},setEquipments(e){this.equipments=e},setAmenities(e){this.amenities=e},setAddress(e,t,s){this.address={state:e,city:t,address:s}},clear(){this.photos=[],this.title="",this.description="",this.address={state:null,city:null,address:null},this.equipments=[],this.amenities=[]}},getters:{getEquipments:e=>e.equipments,getAmenities:e=>e.amenities}})},87394:function(e,t,s){s.d(t,{Z:function(){return C}});s(57658);var a=s(66252),o=s(3577),n=s(2262),i=s(31810),l=s(47209),d=s(61081),r=s(22201),c=s(37891),u=s(87794),m=s(25934),p=s(16025),h=s(49316),v=s(95267),_=s(65277);const g={class:"form-row"},f={class:"form-row"},y={class:"form-row"},b={class:"form-row"},w={class:"address-container"},k={class:"form-row"};var U=(0,a.aZ)({__name:"GymForm",props:{buttonText:{default:"Save"},previewButton:{type:Boolean},footerFixed:{type:Boolean},edit:{type:Boolean}},emits:["submit","on-delete-media"],setup(e,{expose:t,emit:s}){const U=e,{load:A,refetch:q}=(0,h.td)(u.Oo,{first:15,name:"",state_code:""});A();const C=(0,r.tv)(),$=(0,v.d)(),E=(0,a.Fl)((()=>$.photos)),P=(0,a.Fl)((()=>$.title)),x=e=>{$.setTitle(e)},F=(0,a.Fl)((()=>$.description)),S=e=>{$.setDescription(e)},W=(0,a.Fl)((()=>$.equipments)),D=(0,a.Fl)((()=>$.amenities)),Z=(0,n.iH)(null),T=e=>{$.setEquipments(e.equipments||[]),$.setAmenities(e.amenities||[])},M=(0,a.Fl)((()=>$.address.state)),B=(0,a.Fl)((()=>$.address.city)),H=(0,a.Fl)((()=>$.address.address)),N=()=>{Z.value?.present({title:"Amenities",equipments:$.getEquipments.map((e=>e.id)),amenities:$.getAmenities.map((e=>e.id))})},O=(0,n.iH)(null),j=e=>{let t="",s="";const a={latitude:e.geometry.location.lat().toString(),longitude:e.geometry.location.lng().toString(),countryCode:"",countryName:"",postalCode:"",administrativeArea:"",subAdministrativeArea:"",locality:"",subLocality:"",thoroughfare:"",subThoroughfare:"",areasOfInterest:[]};for(let o=0;o<e.address_components.length;o++)e.address_components[o].types.includes("postal_code")&&(a.postalCode=e.address_components[o].long_name),e.address_components[o].types.includes("locality")&&(a.locality=e.address_components[o].long_name),e.address_components[o].types.includes("subLocality")&&(a.subLocality=e.address_components[o].long_name),e.address_components[o].types.includes("country")&&(a.countryName=e.address_components[o].long_name,a.countryCode=e.address_components[o].short_name),e.address_components[o].types.includes("administrative_area_level_1")&&(a.administrativeArea=e.address_components[o].short_name),e.address_components[o].types.includes("administrative_area_level_2")&&(a.subAdministrativeArea=e.address_components[o].long_name),e.address_components[o].types.includes("street_number")&&(t=e.address_components[o].long_name),e.address_components[o].types.includes("route")&&(s=e.address_components[o].long_name);return a.thoroughfare=t+" "+s,a},z=e=>{if(e){console.log("selected place",M.value,B.value,H.value);const t=j(e);t.locality&&q({first:15,name:t.locality,state_code:t.administrativeArea})?.then((async e=>{const s=e.data.cities.data[0];console.log("selected city",s),$.setAddress(s.state,s,t)}))}},G=e=>{$.setAddress(e.state,e.city,e.address)},I=(0,n.iH)(!1),L=(0,n.iH)(),Q=async(e,t)=>{const s=(0,p.U)(e,(0,m.Z)());I.value=!0,L.value=0,await Y({file:s}).then((e=>{$.addPhoto({path:e?.data.filePreload.path,url:`${{NODE_ENV:"production",BASE_URL:"/"}.VUE_APP_MEDIA_URL}${e?.data.filePreload.path}`},t),I.value=!1,L.value=void 0})).catch((e=>{console.error(e),R(),I.value=!1,L.value=void 0}))};let R;const{mutate:Y}=(0,h.Db)(u.nu,{context:{fetchOptions:{useUpload:!0,onProgress:e=>{L.value=e.loaded/e.total*100},onAbortPossible:e=>{R=e}}}}),V=(e,t)=>{$.deletePhoto(e),U.edit&&t&&s("on-delete-media",t)},J=()=>{C.push({name:d.N.FacilityPreview})},K=()=>{console.log("selected address",M.value,B.value,H.value),s("submit",{title:P.value,description:F.value,photos:E.value,address:{state:M.value,city:B.value,address:H.value},equipments:W.value,amenities:D.value})},X=()=>{$.clear()};return t({clearStore:X}),(e,t)=>{const s=(0,a.up)("base-input"),d=(0,a.up)("ion-text"),r=(0,a.up)("GMapAutocomplete"),u=(0,a.up)("choose-block");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a._)("div",{class:(0,o.C_)(["inputs-form",{"inputs-form--footer-fixed":e.footerFixed}])},[(0,a._)("div",g,[(0,a.Wm)((0,n.SU)(i.Q$),{class:"label"},{default:(0,a.w5)((()=>[(0,a.Uk)(" Choose photos for gym ")])),_:1}),(0,a.Wm)(l.Z,{onUpload:Q,onDelete:V,onChange:Q,"circle-shape":!1,photos:E.value,loading:I.value,progress:L.value},null,8,["photos","loading","progress"])]),(0,a._)("div",f,[(0,a.Wm)(s,{required:"",onChange:x,value:P.value,"onUpdate:value":t[0]||(t[0]=e=>P.value=e),placeholder:"Enter title for gym",label:"Whatâ€™s the name of your gym"},null,8,["value"])]),(0,a._)("div",y,[(0,a.Wm)(s,{rows:3,maxlength:150,label:"Describe your gym",onChange:S,value:F.value,"onUpdate:value":t[1]||(t[1]=e=>F.value=e),placeholder:"Enter description for gym"},null,8,["value"])]),(0,a._)("div",b,[(0,a.Wm)((0,n.SU)(i.Q$),{class:"label"},{default:(0,a.w5)((()=>[(0,a.Uk)(" Choose your gym location ")])),_:1}),(0,a._)("div",w,[(0,a.Wm)(d,{class:"address-content"},{default:(0,a.w5)((()=>[(0,a.Uk)(" Address ")])),_:1}),H.value?.thoroughfare?((0,a.wg)(),(0,a.j4)(d,{key:0,class:"address-content"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(`${H.value?.thoroughfare} ${H.value?.subThoroughfare}`)+", "+(0,o.zw)(`${B.value?.name}`)+", "+(0,o.zw)(`${B.value?.state?.name}`),1)])),_:1})):(0,a.kq)("",!0)]),(0,a.Wm)(r,{placeholder:"Enter your address",class:(0,o.C_)(["search-form__control",{"search-form__control--on-focus":e.isFocused}]),onPlace_changed:z},null,8,["class"])]),(0,a._)("div",k,[(0,a.Wm)((0,n.SU)(i.Q$),{class:"label"},{default:(0,a.w5)((()=>[(0,a.Uk)(" Choose equipment and amenitites ")])),_:1}),(0,a.Wm)(u,{title:"Equipment and amenities",onHandleClick:N,value:W.value?.length+D.value?.length||""},null,8,["value"])]),(0,a._)("div",{class:(0,o.C_)(["actions-wrapper",{"actions-wrapper--fixed":e.footerFixed}])},[e.previewButton?((0,a.wg)(),(0,a.j4)((0,n.SU)(i.YG),{key:0,expand:"block",class:"secondary",onClick:J,disabled:!P.value?.length||!E.value?.length||!H.value},{default:(0,a.w5)((()=>[(0,a.Uk)(" Preview ")])),_:1},8,["disabled"])):(0,a.kq)("",!0),(0,a.Wm)((0,n.SU)(i.YG),{expand:"block",onClick:K,disabled:!P.value?.length||!E.value?.length||!H.value},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.buttonText),1)])),_:1},8,["disabled"])],2)],2),(0,a.Wm)(c.Z,{ref_key:"chooseAddressModal",ref:O,onSelect:G},null,512),(0,a.Wm)(_.Z,{ref_key:"equipmentAndAmenitiessModal",ref:Z,onCancel:T},null,512)],64)}}}),A=s(83744);const q=(0,A.Z)(U,[["__scopeId","data-v-27bb06a6"]]);var C=q},99682:function(e,t,s){s.r(t),s.d(t,{default:function(){return f}});s(57658);var a=s(66252),o=s(2262),n=s(10121),i=s(31810),l=s(19239),d=s(87394),r=s(22201),c=s(95267),u=s(87794),m=s(49316),p=s(25934);const h={key:1,class:"content"};var v=(0,a.aZ)({__name:"EditGym",setup(e){const t=(0,r.tv)(),s=(0,r.yj)(),v=(0,c.d)(),_=(0,o.iH)(null),{onResult:g,result:f,loading:y,refetch:b}=(0,m.aM)(u.en,{},{fetchPolicy:"no-cache"}),{mutate:w}=(0,m.Db)(u.zR),{mutate:k}=(0,m.Db)(u.O9),U=()=>{v.clear(),t.go(-1)},A=e=>{k({id:e})},q=(0,o.Fl)((()=>f.value?.me?.owned_facilities[0].id));g((({data:e})=>{const t=e.me?.owned_facilities.filter((e=>e.id===s.query.facilityId));if(t?.length){v.setAddress(t[0].address?.city.state,t[0].address?.city,{thoroughfare:t[0].address?.street,subThoroughfare:t[0].address?.extra,latitude:t[0].address?.lat,longitude:t[0].address?.lng});const e=t[0]?.amenities?.map((e=>({id:e.id,label:e.name||"",value:e.id||"",isChecked:!0,iconUrl:e.iconUrl||void 0}))),s=t[0]?.equipments?.map((e=>({id:e.id,label:e.name||"",value:e.id||"",isChecked:!0,iconUrl:e.iconUrl||void 0})));t[0].media?.map((e=>{v.addPhoto({...e,url:e.pathUrl})})),v.setAmenities(e),v.setDescription(t[0].description),v.setEquipments(s),v.setTitle(t[0].name)}}));const C=()=>{w({id:q.value,input:{name:v.$state.title,description:v.$state.description,address:{lat:Number(v.$state.address.address?.latitude),lng:Number(v.$state.address.address?.longitude),street:v.$state.address.address?.thoroughfare,city_id:v.$state.address.city?.id,extra:v.$state.address.address?.subThoroughfare},media:v.$state.photos.reduce(((e,t)=>(t.id||e.push({title:(0,p.Z)(),file:t.path?t.path:""}),e)),[]),equipments:v.$state.equipments.map((e=>e.id)),amenities:v.$state.amenities.map((e=>e.id))}}).then((async()=>{const e=await i.Mn.create({message:"Updated successfully",duration:2e3,icon:"assets/icon/success.svg",cssClass:"success-toast"});e.present(),b()})).catch((async e=>{const t=await i.Mn.create({message:"Something went wrong. Please try again.",icon:"assets/icon/info.svg",cssClass:"danger-toast"});throw t.present(),new Error(e)}))};return(e,t)=>((0,a.wg)(),(0,a.j4)(n.Z,{"hide-navigation-menu":""},{header:(0,a.w5)((()=>[(0,a.Wm)(l.Z,{"back-btn":"",onBack:U,title:"Edit gym profile"})])),content:(0,a.w5)((()=>[(0,o.SU)(y)?((0,a.wg)(),(0,a.j4)((0,o.SU)(i.PQ),{key:0,name:"lines",class:"spinner"})):((0,a.wg)(),(0,a.iD)("div",h,[(0,a.Wm)(d.Z,{ref_key:"gymForm",ref:_,"button-text":"Save",onSubmit:C,onOnDeleteMedia:A,edit:""},null,512)]))])),_:1}))}}),_=s(83744);const g=(0,_.Z)(v,[["__scopeId","data-v-151d6fec"]]);var f=g}}]);
//# sourceMappingURL=9635.96440a2f.js.map