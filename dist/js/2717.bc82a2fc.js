"use strict";(self["webpackChunkspotter"]=self["webpackChunkspotter"]||[]).push([[2717],{35651:function(e,a,t){t.r(a),t.d(a,{default:function(){return E}});t(57658);var s=t(66252),i=t(2262),n=t(3577),l=t(10121),r=t(19239),c=t(9913),o=t(31810),d=t(61081),u=t(54354),m=t(87794),v=t(49316),g=t(27893),h=t(99313),y=t(91389),f=t(27484),_=t.n(f),p=t(22201),k=t(43173),b=t(89355),Y=t(98938),w=t(82544);const U={key:0,class:"header-btn__badge"},S={class:"dashboard"},M={class:"dashboards-items"},N={class:"rating__container"},D={class:"events__container"},F={name:"Dashboard"};var H=(0,s.aZ)({...F,setup(e){const a=(0,p.tv)(),{id:t}=(0,k.Z)(),f=(0,i.iH)([]),{result:F,loading:H,refetch:W}=(0,v.aM)(m.VH,{page:1,first:4,start_date:{from:_()().format("YYYY-MM-DD HH:mm:ss"),to:_()().add(1,"M").format("YYYY-MM-DD HH:mm:ss")},orderBy:[{column:m.wL.StartDate,order:m.As.Asc}]},{fetchPolicy:"no-cache"}),{result:Z,loading:E,refetch:T}=(0,v.aM)(m.tM,{page:1,first:4,start_date:{from:_()().format("YYYY-MM-DD HH:mm:ss"),to:_()().add(1,"M").format("YYYY-MM-DD HH:mm:ss")},orderBy:[{column:m.Vy.StartDate,order:m.As.Asc}]},{fetchPolicy:"no-cache"}),{result:A,loading:C,refetch:I}=(0,v.aM)(m.jn,{page:1,first:4,orderBy:[{column:m.LP.StartDate,order:m.As.Asc}]},{fetchPolicy:"no-cache"}),{result:P}=(0,v.aM)(m.o),{result:V}=(0,v.aM)(m.MF,{id:t,from:_()().startOf("d").format("YYYY-MM-DD HH:mm:ss"),to:_()().day(6).endOf("d").format("YYYY-MM-DD HH:mm:ss")},{fetchPolicy:"no-cache"}),j=(0,s.Fl)((()=>{const e=[];if(V&&V?.value){const a=V?.value?.userAvailability;if(a&&a?.events){const{events:t}=a,s=t.map((e=>({start_date:e?.start_date||null})));e.push(...s)}if(a&&a?.trainings){const{trainings:t}=a,s=t.filter((e=>e.state===m.Z3.Accepted)).map((e=>({start_date:e?.start_date||null})));e.push(...s)}}return e})),B=()=>{f.value.length&&(f.value=[]),(0,b.jM)(Y.AZ,(e=>{e.forEach((e=>{const a=e.val();a.unread&&a.unread[t]&&f.value.push(a.unread[t])}))}))};(0,s.bv)((()=>{B()}));const q=(0,s.Fl)((()=>P?.value?.me||[])),$=(0,s.Fl)((()=>[{value:q?.value?.reviews_count||0,description:"total feedbacks"}])),G=(0,s.Fl)((()=>[{value:q?.value?.checkins_count||0,description:"gym check-ins"},{value:q?.value?.completed_trainings_count||0,description:"trainings done"}])),L=(0,s.Fl)((()=>F?.value?.myEvents?.data?F.value.myEvents.data:[])),x=(0,s.Fl)((()=>Z?.value?.myTrainings?.data?Z.value.myTrainings.data.map((e=>({...e,title:`${e.trainer.first_name} ${e.trainer.last_name}`,address:e.trainer.address,media:[{pathUrl:e.trainer.avatarUrl}]}))):[])),z=(0,s.Fl)((()=>A?.value?.myFacilityItemPasses?.data?A.value.myFacilityItemPasses.data.map((e=>({id:e.id,title:e.facilityItem.facility.name,end_date:e.end_date,start_date:_()(e.end_date).subtract(e.facilityItem.qr_code_lifetime_value??0,"d").format("YYYY-MM-DD HH:mm:ss"),media:e.facilityItem.facility.media,address:e.facilityItem.facility.address}))):[])),O=(0,s.Fl)((()=>J.value===d.N.Events?L.value:J.value===d.N.Facilities?z.value:x.value)),K=(0,s.Fl)((()=>J.value===d.N.Events?"events":J.value===d.N.Facilities?"gyms":"trainings")),Q=[{name:d.N.Facilities,label:"Gyms"},{name:d.N.Trainings,label:"Trainings"},{name:d.N.Events,label:"Events"}],R=(0,i.iH)(_()()),J=(0,i.iH)(localStorage.getItem("dashboard_active_tab")||d.N.Facilities),X=e=>{e&&(J.value=e,localStorage.setItem("dashboard_active_tab",J.value),ee())},ee=()=>{switch(J.value){case d.N.Events:W();break;case d.N.Trainings:T();break;case d.N.Facilities:I();break;default:break}},ae=()=>{a.push({name:d.N.DashboardEvents})},te=()=>{a.push({name:d.N.ChatList})},se=()=>{a.push({name:d.N.Favourites})},ie=()=>{a.push({name:d.N.DashboardCalendar})},ne=e=>{switch(J.value){case d.N.Facilities:return a.push({name:d.N.BookedTraining,params:{id:e},query:{type:d.N.Facility}});case d.N.Trainings:return a.push({name:d.N.BookedTraining,params:{id:e},query:{type:d.N.Training}});case d.N.Events:return a.push({name:d.N.BookedTraining,params:{id:e},query:{type:d.N.Event}});default:break}};return(e,a)=>((0,s.wg)(),(0,s.j4)(l.Z,null,{header:(0,s.w5)((()=>[(0,s.Wm)(r.Z,{title:"My Dashboard"},{"custom-btn":(0,s.w5)((()=>[(0,s.Wm)((0,i.SU)(o.YG),{onClick:te,class:"header-btn"},{default:(0,s.w5)((()=>[(0,s.Wm)((0,i.SU)(o.gu),{src:"assets/icon/chat.svg"}),f.value.length?((0,s.wg)(),(0,s.iD)("span",U)):(0,s.kq)("",!0)])),_:1}),(0,s.Wm)((0,i.SU)(o.YG),{onClick:se,class:"header-btn"},{default:(0,s.w5)((()=>[(0,s.Wm)((0,i.SU)(o.gu),{src:"assets/icon/heart.svg"})])),_:1})])),_:1})])),content:(0,s.w5)((()=>[(0,s._)("div",S,[(0,s._)("div",M,[(0,s.Wm)(c.Z,{items:G.value},{title:(0,s.w5)((()=>[(0,s.Wm)((0,i.SU)(o.gu),{src:"assets/icon/activity.svg",class:"activity-icon"}),(0,s.Uk)(" Activity ")])),_:1},8,["items"]),(0,s.Wm)(c.Z,{items:$.value},{title:(0,s.w5)((()=>[(0,s.Wm)((0,i.SU)(o.gu),{src:"assets/icon/trophy.svg",class:"trophy-icon"}),(0,s.Uk)(" My Ratings ")])),bottom:(0,s.w5)((()=>[(0,s._)("div",N,[(0,s.Wm)((0,i.SU)(o.yW),{class:"rating-likes"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,n.zw)(q.value?.positive_reviews_count||0)+" ",1),(0,s.Wm)((0,i.SU)(o.gu),{class:"like-icon",src:"assets/icon/like.svg"})])),_:1}),(0,s.Wm)((0,i.SU)(o.yW),{class:"rating-dislikes"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,n.zw)(q.value?.negative_reviews_count||0)+" ",1),(0,s.Wm)((0,i.SU)(o.gu),{class:"dislike-icon",src:"assets/icon/dislike.svg"})])),_:1})])])),_:1},8,["items"])]),(0,s.Wm)(y.Z,{modelValue:R.value,"onUpdate:modelValue":a[0]||(a[0]=e=>R.value=e),bookings:j.value,onHandleView:ie},null,8,["modelValue","bookings"]),(0,s._)("div",D,[(0,s.Wm)(h.Z,{title:"Upcoming bookings",onHandleView:ae,"hide-view-more":!O.value?.length||(0,i.SU)(C)||(0,i.SU)(E)||(0,i.SU)(H)},null,8,["hide-view-more"]),!O.value.length||(0,i.SU)(E)||(0,i.SU)(H)||(0,i.SU)(C)?(0,i.SU)(E)||(0,i.SU)(H)||(0,i.SU)(C)?((0,s.wg)(),(0,s.j4)((0,i.SU)(o.PQ),{key:1,name:"lines",class:"spinner"})):((0,s.wg)(),(0,s.j4)(w.Z,{key:2,"hide-button":"",icon:"assets/icon/empty.svg",title:`Sorry, no ${K.value} found`,text:`Currently you have no booked ${K.value}`},null,8,["title","text"])):((0,s.wg)(!0),(0,s.iD)(s.HY,{key:0},(0,s.Ko)(O.value,(e=>((0,s.wg)(),(0,s.j4)(g.Z,{key:e.id,item:e,rounded:J.value===(0,i.SU)(d.N).Trainings,"date-range":J.value===(0,i.SU)(d.N).Facilities,onClick:a=>ne(e.id)},null,8,["item","rounded","date-range","onClick"])))),128))]),(0,s.Wm)(u.Z,{tabs:Q,class:"page-tabs",value:J.value,onChange:X},null,8,["value"])])])),_:1}))}}),W=t(83744);const Z=(0,W.Z)(H,[["__scopeId","data-v-464dc8d1"]]);var E=Z}}]);
//# sourceMappingURL=2717.bc82a2fc.js.map