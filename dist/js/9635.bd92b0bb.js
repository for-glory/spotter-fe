"use strict";(self["webpackChunkspotter"]=self["webpackChunkspotter"]||[]).push([[9635],{95267:function(e,t,s){s.d(t,{d:function(){return n}});s(57658);var a=s(26089);const n=(0,a.Q_)("new-facility",{state:()=>({photos:[],title:"",description:"",address:{state:null,city:null,address:null},equipments:[],amenities:[]}),actions:{addPhoto(e,t){t?this.photos[t]=e:this.photos.push(e)},deletePhoto(e){this.photos.splice(e,1)},setTitle(e){this.title=e},setDescription(e){this.description=e},setEquipments(e){this.equipments=e},setAmenities(e){this.amenities=e},setAddress(e,t,s){this.address={state:e,city:t,address:s}},clear(){this.photos=[],this.title="",this.description="",this.address={state:null,city:null,address:null},this.equipments=[],this.amenities=[]}},getters:{getEquipments:e=>e.equipments,getAmenities:e=>e.amenities}})},26482:function(e,t,s){s.d(t,{Z:function(){return C}});s(57658);var a=s(66252),n=s(3577),o=s(2262),i=s(31810),l=s(47209),d=s(61081),r=s(22201),u=s(37891),c=s(87794),m=s(25934),p=s(16025),h=s(49316),v=s(95267),_=s(65277);const g={class:"form-row"},f={class:"form-row"},y={class:"form-row"},b={class:"form-row"},w={class:"address-container"},k={class:"form-row"};var U=(0,a.aZ)({__name:"GymForm",props:{buttonText:{default:"Save"},previewButton:{type:Boolean},saveAndExitButton:{type:Boolean},footerFixed:{type:Boolean},edit:{type:Boolean}},emits:["submit","on-delete-media"],setup(e,{expose:t,emit:s}){const U=e,{load:A,refetch:q}=(0,h.td)(c.Oo,{first:15,name:"",state_code:""});A();const C=(0,r.tv)(),E=(0,v.d)(),P=(0,a.Fl)((()=>E.photos)),x=(0,a.Fl)((()=>E.title)),$=e=>{E.setTitle(e)},S=(0,a.Fl)((()=>E.description)),F=e=>{E.setDescription(e)},D=(0,a.Fl)((()=>E.equipments)),W=(0,a.Fl)((()=>E.amenities)),Z=(0,o.iH)(null),T=e=>{E.setEquipments(e.equipments||[]),E.setAmenities(e.amenities||[])},B=(0,a.Fl)((()=>E.address.state)),G=(0,a.Fl)((()=>E.address.city)),H=(0,a.Fl)((()=>E.address.address)),I=()=>{Z.value?.present({title:"Amenities",equipments:E.getEquipments.map((e=>e.id)),amenities:E.getAmenities.map((e=>e.id))})},L=(0,o.iH)(null),M=e=>{let t="",s="";const a={latitude:e.geometry.location.lat().toString(),longitude:e.geometry.location.lng().toString(),countryCode:"",countryName:"",postalCode:"",administrativeArea:"",subAdministrativeArea:"",locality:"",subLocality:"",thoroughfare:"",subThoroughfare:"",areasOfInterest:[]};for(let n=0;n<e.address_components.length;n++)e.address_components[n].types.includes("postal_code")&&(a.postalCode=e.address_components[n].long_name),e.address_components[n].types.includes("locality")&&(a.locality=e.address_components[n].long_name),e.address_components[n].types.includes("subLocality")&&(a.subLocality=e.address_components[n].long_name),e.address_components[n].types.includes("country")&&(a.countryName=e.address_components[n].long_name,a.countryCode=e.address_components[n].short_name),e.address_components[n].types.includes("administrative_area_level_1")&&(a.administrativeArea=e.address_components[n].short_name),e.address_components[n].types.includes("administrative_area_level_2")&&(a.subAdministrativeArea=e.address_components[n].long_name),e.address_components[n].types.includes("street_number")&&(t=e.address_components[n].long_name),e.address_components[n].types.includes("route")&&(s=e.address_components[n].long_name);return a.thoroughfare=t+" "+s,a},N=e=>{if(e){console.log("selected place",B.value,G.value,H.value);const t=M(e);t.locality&&q({first:15,name:t.locality,state_code:t.administrativeArea})?.then((async e=>{const s=e.data.cities.data[0];console.log("selected city",s),E.setAddress(s.state,s,t)}))}},O=e=>{E.setAddress(e.state,e.city,e.address)},j=(0,o.iH)(!1),z=(0,o.iH)(),Q=async(e,t)=>{const s=(0,p.U)(e,(0,m.Z)());j.value=!0,z.value=0,await V({file:s}).then((e=>{E.addPhoto({path:e?.data.filePreload.path,url:`${{NODE_ENV:"production",VUE_APP_API_URL:"https://api.spotterfitness.com/graphql",VUE_APP_GOOGLE_AUTH_CLIENT_ID:"",BASE_URL:"/"}.VUE_APP_MEDIA_URL}${e?.data.filePreload.path}`},t),j.value=!1,z.value=void 0})).catch((e=>{console.error(e),R(),j.value=!1,z.value=void 0}))};let R;const{mutate:V}=(0,h.Db)(c.nu,{context:{fetchOptions:{useUpload:!0,onProgress:e=>{z.value=e.loaded/e.total*100},onAbortPossible:e=>{R=e}}}}),Y=(e,t)=>{E.deletePhoto(e),U.edit&&t&&s("on-delete-media",t)},J=()=>{C.push({name:d.N.FacilityPreview})},K=()=>{s("submit",{title:x.value,description:S.value,photos:P.value,address:{state:B.value,city:G.value,address:H.value},equipments:D.value,amenities:W.value},"exit")},X=()=>{s("submit",{title:x.value,description:S.value,photos:P.value,address:{state:B.value,city:G.value,address:H.value},equipments:D.value,amenities:W.value},"create_event")},ee=()=>{E.clear()};return t({clearStore:ee}),(e,t)=>{const s=(0,a.up)("base-input"),d=(0,a.up)("choose-block"),r=(0,a.up)("ion-text"),c=(0,a.up)("GMapAutocomplete");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a._)("div",{class:(0,n.C_)(["inputs-form",{"inputs-form--footer-fixed":e.footerFixed}])},[(0,a._)("div",g,[(0,a.Wm)((0,o.SU)(i.Q$),{class:"label"},{default:(0,a.w5)((()=>[(0,a.Uk)(" Choose photos for gym ")])),_:1}),(0,a.Wm)(l.Z,{onUpload:Q,onDelete:Y,onChange:Q,"circle-shape":!1,photos:P.value,loading:j.value,progress:z.value},null,8,["photos","loading","progress"])]),(0,a._)("div",f,[(0,a.Wm)(s,{required:"",onChange:$,value:x.value,"onUpdate:value":t[0]||(t[0]=e=>x.value=e),placeholder:"Enter title for gym",label:"Gym name"},null,8,["value"])]),(0,a._)("div",y,[(0,a.Wm)((0,o.SU)(i.Q$),{class:"label"},{default:(0,a.w5)((()=>[(0,a.Uk)(" Choose equipment and amenitites ")])),_:1}),(0,a.Wm)(d,{title:"Equipment and amenities",onHandleClick:I,value:D.value?.length+W.value?.length||""},null,8,["value"])]),(0,a._)("div",b,[(0,a.Wm)((0,o.SU)(i.Q$),{class:"label"},{default:(0,a.w5)((()=>[(0,a.Uk)(" Choose your gym location ")])),_:1}),(0,a._)("div",w,[(0,a.Wm)(r,{class:"address-content"},{default:(0,a.w5)((()=>[(0,a.Uk)(" Address ")])),_:1}),H.value?.thoroughfare?((0,a.wg)(),(0,a.j4)(r,{key:0,class:"address-content"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,n.zw)(`${H.value?.thoroughfare} ${H.value?.subThoroughfare}`)+", "+(0,n.zw)(`${G.value?.name}`)+", "+(0,n.zw)(`${G.value?.state?.name}`),1)])),_:1})):(0,a.kq)("",!0)]),(0,a.Wm)(c,{placeholder:"Enter your address",class:(0,n.C_)(["search-form__control",{"search-form__control--on-focus":e.isFocused}]),onPlace_changed:N},null,8,["class"])]),(0,a._)("div",k,[(0,a.Wm)(s,{rows:3,maxlength:150,label:"Describe your gym",onChange:F,value:S.value,"onUpdate:value":t[1]||(t[1]=e=>S.value=e),placeholder:"Enter description for gym"},null,8,["value"])]),(0,a._)("div",{class:(0,n.C_)(["actions-wrapper",{"actions-wrapper--fixed":e.footerFixed}])},[e.previewButton?((0,a.wg)(),(0,a.j4)((0,o.SU)(i.YG),{key:0,expand:"block",class:"secondary",onClick:J,disabled:!x.value?.length||!P.value?.length||!H.value},{default:(0,a.w5)((()=>[(0,a.Uk)(" Preview ")])),_:1},8,["disabled"])):(0,a.kq)("",!0),e.saveAndExitButton?((0,a.wg)(),(0,a.j4)((0,o.SU)(i.YG),{key:1,expand:"block",class:"secondary",onClick:K,disabled:!x.value?.length||!P.value?.length||!H.value},{default:(0,a.w5)((()=>[(0,a.Uk)(" Save & Exit ")])),_:1},8,["disabled"])):(0,a.kq)("",!0),(0,a.Wm)((0,o.SU)(i.YG),{expand:"block",onClick:X,disabled:!x.value?.length||!P.value?.length||!H.value},{default:(0,a.w5)((()=>[(0,a.Uk)((0,n.zw)(e.buttonText),1)])),_:1},8,["disabled"])],2)],2),(0,a.Wm)(u.Z,{ref_key:"chooseAddressModal",ref:L,onSelect:O},null,512),(0,a.Wm)(_.Z,{ref_key:"equipmentAndAmenitiessModal",ref:Z,onCancel:T},null,512)],64)}}}),A=s(83744);const q=(0,A.Z)(U,[["__scopeId","data-v-4c1b3752"]]);var C=q},99682:function(e,t,s){s.r(t),s.d(t,{default:function(){return f}});s(57658);var a=s(66252),n=s(2262),o=s(10121),i=s(31810),l=s(19239),d=s(26482),r=s(22201),u=s(95267),c=s(87794),m=s(49316),p=s(25934);const h={key:1,class:"content"};var v=(0,a.aZ)({__name:"EditGym",setup(e){const t=(0,r.tv)(),s=(0,r.yj)(),v=(0,u.d)(),_=(0,n.iH)(null),{onResult:g,result:f,loading:y,refetch:b}=(0,m.aM)(c.en,{},{fetchPolicy:"no-cache"}),{mutate:w}=(0,m.Db)(c.zR),{mutate:k}=(0,m.Db)(c.O9),U=()=>{v.clear(),t.go(-1)},A=e=>{k({id:e})},q=(0,n.Fl)((()=>f.value?.me?.owned_facilities[0].id));g((({data:e})=>{const t=e.me?.owned_facilities.filter((e=>e.id===s.query.facilityId));if(t?.length){v.setAddress(t[0].address?.city.state,t[0].address?.city,{thoroughfare:t[0].address?.street,subThoroughfare:t[0].address?.extra,latitude:t[0].address?.lat,longitude:t[0].address?.lng});const e=t[0]?.amenities?.map((e=>({id:e.id,label:e.name||"",value:e.id||"",isChecked:!0,iconUrl:e.iconUrl||void 0}))),s=t[0]?.equipments?.map((e=>({id:e.id,label:e.name||"",value:e.id||"",isChecked:!0,iconUrl:e.iconUrl||void 0})));t[0].media?.map((e=>{v.addPhoto({...e,url:e.pathUrl})})),v.setAmenities(e),v.setDescription(t[0].description),v.setEquipments(s),v.setTitle(t[0].name)}}));const C=()=>{w({id:q.value,input:{name:v.$state.title,description:v.$state.description,address:{lat:Number(v.$state.address.address?.latitude),lng:Number(v.$state.address.address?.longitude),street:v.$state.address.address?.thoroughfare,city_id:v.$state.address.city?.id,extra:v.$state.address.address?.subThoroughfare},media:v.$state.photos.reduce(((e,t)=>(t.id||e.push({title:(0,p.Z)(),file:t.path?t.path:""}),e)),[]),equipments:v.$state.equipments.map((e=>e.id)),amenities:v.$state.amenities.map((e=>e.id))}}).then((async()=>{const e=await i.Mn.create({message:"Updated successfully",duration:2e3,icon:"assets/icon/success.svg",cssClass:"success-toast"});e.present(),b()})).catch((async e=>{const t=await i.Mn.create({message:"Something went wrong. Please try again.",icon:"assets/icon/info.svg",cssClass:"danger-toast"});throw t.present(),new Error(e)}))};return(e,t)=>((0,a.wg)(),(0,a.j4)(o.Z,{"hide-navigation-menu":""},{header:(0,a.w5)((()=>[(0,a.Wm)(l.Z,{"back-btn":"",onBack:U,title:"Edit gym profile"})])),content:(0,a.w5)((()=>[(0,n.SU)(y)?((0,a.wg)(),(0,a.j4)((0,n.SU)(i.PQ),{key:0,name:"lines",class:"spinner"})):((0,a.wg)(),(0,a.iD)("div",h,[(0,a.Wm)(d.Z,{ref_key:"gymForm",ref:_,"button-text":"Save",onSubmit:C,onOnDeleteMedia:A,edit:""},null,512)]))])),_:1}))}}),_=s(83744);const g=(0,_.Z)(v,[["__scopeId","data-v-151d6fec"]]);var f=g}}]);
//# sourceMappingURL=9635.bd92b0bb.js.map