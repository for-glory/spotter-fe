"use strict";(self["webpackChunkspotter"]=self["webpackChunkspotter"]||[]).push([[1867],{40411:function(e,a,t){t.d(a,{b:function(){return n}});var s=t(29895);const n=(0,s.fo)("Geolocation",{web:()=>t.e(6642).then(t.bind(t,56642)).then((e=>new e.GeolocationWeb))})},76111:function(e,a,t){t.d(a,{T:function(){return n}});t(57658);const s=15,n=()=>[...Array(s)].map(((e,a)=>a)).reduce(((e,a)=>(e.push({text:String(a+1),value:String(++a)}),e)),[])},38747:function(e,a,t){t.d(a,{s:function(){return n}});var s=t(26089);const n=(0,s.Q_)("seleted-address",{state:()=>({assignedFacility:null,hourlyRate:null,remoteHourlyRate:null,travelRadius:null,useTrainerLocation:!1,workingInGym:!1,edit:!1}),actions:{setEdit(e){this.edit=e},setAssignedFacility(e){this.assignedFacility=e},setWorkinginGym(e){this.workingInGym=e},setHourlyRate(e){this.hourlyRate=e},setRemoteHourlyRate(e){this.remoteHourlyRate=e},setTravelRadius(e){this.travelRadius=e},setUseTrainerLocation(e){this.useTrainerLocation=e},clearState(){this.assignedFacility=null,this.hourlyRate=null,this.remoteHourlyRate=null,this.travelRadius=null,this.useTrainerLocation=!1},clearAssignedFacility(){this.assignedFacility=null}}})},13936:function(e,a,t){t.d(a,{Z:function(){return i}});var s=t(66252),n=t(31810),o=(0,s.aZ)({__name:"WheelPicker",props:{options:{},name:{default:""},values:{}},setup(e){const a=e,t=async()=>{const e=a.values,t=a.options.columns.map(((a,t)=>{const s=a.options.map((e=>({value:e.value,text:e.text})));return{name:a.name,options:s,selectedIndex:e?a.options.findIndex((a=>a.value===e[t])):-1}})),s=await n._E.create({buttons:a.options.buttons,mode:"ios",columns:t});await s.present()},o=(0,s.f3)("emitter");return o?.on("open-picker",(e=>{e===a.name&&t()})),(0,s.Ah)((()=>{o?.off("open-picker")})),(e,a)=>(0,s.WI)(e.$slots,"button")}});const l=o;var i=l},18882:function(e,a,t){t.d(a,{Z:function(){return d}});var s=t(66252),n=t(2262),o=t(3577),l=t(31810);const i={class:"buttons__container"};var r=(0,s.aZ)({__name:"ButtonsFooter",props:{mainButtonText:{},secondaryButtonText:{default:""},disabled:{type:Boolean,default:!1}},emits:["handle-click","handle-secondary-click"],setup(e){return(e,a)=>((0,s.wg)(),(0,s.iD)("div",i,[(0,s.Wm)((0,n.SU)(l.YG),{onClick:a[0]||(a[0]=a=>e.$emit("handle-click")),class:"submit-btn",disabled:e.disabled},{default:(0,s.w5)((()=>[(0,s.Uk)((0,o.zw)(e.mainButtonText),1)])),_:1},8,["disabled"]),e.secondaryButtonText?((0,s.wg)(),(0,s.j4)((0,n.SU)(l.YG),{key:0,class:"secondary secondary-btn",onClick:a[1]||(a[1]=a=>e.$emit("handle-secondary-click"))},{default:(0,s.w5)((()=>[(0,s.Uk)((0,o.zw)(e.secondaryButtonText),1)])),_:1})):(0,s.kq)("",!0)]))}}),c=t(83744);const u=(0,c.Z)(r,[["__scopeId","data-v-70d0b6b0"]]);var d=u},87012:function(e,a,t){t.r(a),t.d(a,{default:function(){return M}});t(57658);var s=t(66252),n=t(2262),o=t(3577),l=t(10121),i=t(40411),r=t(19239),c=t(18882),u=t(22201),d=t(61081),m=t(37891),v=t(31810),g=t(76111),y=t(13936),p=t(49316),h=t(87794),f=t(43173),_=t(36874),w=t(38747),b=t(12712);const k={key:1,class:"page"},S={key:0,class:"form-row"},U={class:"form-row"},C={class:"address-container"},T={key:1,class:"form-row"},x={class:"form-row"},A={class:"form-row"},F={class:"form-row"};var H=(0,s.aZ)({__name:"Location",setup(e){const a=(0,u.tv)(),{role:t}=(0,b.Z)(),H=()=>{a.go(-1)},L=(0,n.iH)(null),W=(0,n.iH)(null),M=(0,n.iH)(null),R=(0,n.iH)(null),$=(0,n.iH)(null),Z=(0,n.iH)(!1),{mutate:D,loading:I}=(0,p.Db)(h.sY),{load:P,refetch:O}=(0,p.td)(h.Oo,{first:15,name:"",state_code:""}),{id:G}=(0,f.Z)(),{onResult:z,loading:B,result:Y}=(0,p.aM)(h.en,{id:G},{fetchPolicy:"no-cache"});z((({data:e})=>{e.me.address&&(M.value=e.me.address?.city?.state,R.value=e.me.address?.city,$.value={latitude:e.me.address.lat,longitude:e.me.address.lng,thoroughfare:e.me.address?.street,subThoroughfare:e.me.address?.extra,countryName:e.me.address?.city?.country?.name,locality:e.me.address?.city?.name,administrativeArea:e.me.address?.city?.state?.code}),ee.value=e.me?.settings.find((e=>e.setting.code===h.Lm.TrainerRemoteDistance))?.value??0,ae.value=e.me?.settings.find((e=>e.setting.code===h.Lm.IsMobile))?.value??!1,re.assignedFacility||re.setAssignedFacility(e.me?.facilities[0])}));const N=(0,s.Fl)((()=>Y.value?.me.trainer_type===h.w3.Freelancer));(0,s.bv)((()=>{P()}));const q=(0,n.iH)(!1),Q=async e=>{if(Z.value=e,e){q.value=!0,M.value=null,R.value=null,$.value=null;const e=await i.b.getCurrentPosition();q.value=!1,L.value={lat:e?.coords?.latitude,lng:e?.coords?.longitude}}else L.value=null},j=(0,s.Fl)((()=>Z.value?!Z.value||q.value:!$.value)),E=e=>{let a="",t="";const s={latitude:e.geometry.location.lat().toString(),longitude:e.geometry.location.lng().toString(),countryCode:"",countryName:"",postalCode:"",administrativeArea:"",subAdministrativeArea:"",locality:"",subLocality:"",thoroughfare:"",subThoroughfare:"",areasOfInterest:[]};for(let n=0;n<e.address_components.length;n++)e.address_components[n].types.includes("postal_code")&&(s.postalCode=e.address_components[n].long_name),e.address_components[n].types.includes("locality")&&(s.locality=e.address_components[n].long_name),e.address_components[n].types.includes("subLocality")&&(s.subLocality=e.address_components[n].long_name),e.address_components[n].types.includes("country")&&(s.countryName=e.address_components[n].long_name,s.countryCode=e.address_components[n].short_name),e.address_components[n].types.includes("administrative_area_level_1")&&(s.administrativeArea=e.address_components[n].short_name),e.address_components[n].types.includes("administrative_area_level_2")&&(s.subAdministrativeArea=e.address_components[n].long_name),e.address_components[n].types.includes("street_number")&&(a=e.address_components[n].long_name),e.address_components[n].types.includes("route")&&(t=e.address_components[n].long_name);return s.thoroughfare=a+" "+t,s},J=e=>{e&&($.value=E(e))},K=async e=>{console.log("selected--\x3e",e),M.value=e.state,R.value=e.city,$.value=e.address},V=async()=>{try{const e=await i.b.getCurrentPosition();L.value={lat:e.coords.latitude,lng:e.coords.longitude}}catch(e){const a=await v.Mn.create({message:"Failed to get your location. Check the permissions for the application.",duration:2e3,icon:"assets/icon/info.svg",cssClass:"warning-toast"});a.present(),i.b.requestPermissions()}},X=async()=>{const e={id:G,settings:[{code:h.Lm.UsePhoneLocation,value:Z.value},{code:h.Lm.TrainerRemoteDistance,value:ee.value},{code:h.Lm.IsMobile,value:ae.value}]};if(Z.value){const a={...L.value,extra:""};if(L.value?.lat&&L.value.lng)_.d.reverseGeocode(L.value.lat,L.value.lng,{useLocale:!1,maxResults:5}).then((t=>{const s=t[0];s?.locality&&O({first:15,name:s.locality,state_code:s.administrativeArea})?.then((async t=>{const s=t.data.cities.data[0];if(s)D({...e,...a,city_id:s.id,street:`${s.thoroughfare} ${s.subThoroughfare}`}).then((async()=>{const e=await v.Mn.create({message:"Location successfully updated",duration:2e3,icon:"assets/icon/success.svg",cssClass:"success-toast"});e.present(),H()})).catch((async()=>{const e=await v.Mn.create({message:"Something went wrong. Please try again.",icon:"assets/icon/info.svg",cssClass:"danger-toast"});e.present()}));else{const e=await v.Mn.create({message:"Your address is outside the area. Try to choose manually.",duration:2e3,icon:"assets/icon/info.svg",cssClass:"warning-toast"});e.present()}}))})).catch((e=>{console.log(e)}));else{const e=await v.Mn.create({message:"Something went wrong. Try again.",duration:2e3,icon:"assets/icon/info.svg",cssClass:"warning-toast"});e.present(),V()}}else console.log("selectedAddress--\x3e",$),$.value?.locality&&O({first:15,name:$.value?.locality,state_code:$.value?.administrativeArea})?.then((async a=>{const t=a.data.cities.data[0];if(t){const a={lat:Number($.value?.latitude),lng:Number($.value?.longitude),street:`${$.value?.thoroughfare} ${$.value?.subThoroughfare}`,extra:"",city_id:t.id};D({...e,address:a}).then((async()=>{const e=await v.Mn.create({message:"Location successfully updated",duration:2e3,icon:"assets/icon/success.svg",cssClass:"success-toast"});e.present(),H()})).catch((async()=>{const e=await v.Mn.create({message:"Something went wrong. Please try again.",icon:"assets/icon/info.svg",cssClass:"danger-toast"});e.present()}))}else{const e=await v.Mn.create({message:"Your address is outside the area. Try to choose manually.",duration:2e3,icon:"assets/icon/info.svg",cssClass:"warning-toast"});e.present()}}))},ee=(0,n.iH)(""),ae=(0,n.iH)(!1),te=(0,g.T)(),se=(0,s.f3)("emitter"),ne=e=>{se?.emit("open-picker",e)},oe=[{name:"spacing",options:te},{name:"unit",options:[{text:"MIL",value:"miles"}]}],le={columns:oe,buttons:[{text:"Cancel",role:"cancel"},{text:"Select radius",handler:e=>{ee.value=e.spacing?.value}}]},ie=()=>{a.push({name:d.N.ChooseGymAccount})},re=(0,w.s)(),ce=(0,s.Fl)((()=>re.assignedFacility));return(e,a)=>{const i=(0,s.up)("base-toggle"),u=(0,s.up)("ion-text"),d=(0,s.up)("GMapAutocomplete"),g=(0,s.up)("choose-block");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(l.Z,null,{header:(0,s.w5)((()=>[(0,s.Wm)(r.Z,{"back-btn":"",title:N.value||(0,n.SU)(t)!==(0,n.SU)(h.g8).Manager||(0,n.SU)(t)!==(0,n.SU)(h.g8).FacilityOwner||(0,n.SU)(t)!==(0,n.SU)(h.g8).OrganizationOwner?"Location":"Choose my location",onBack:H,class:"header"},null,8,["title"])])),content:(0,s.w5)((()=>[(0,n.SU)(B)?((0,s.wg)(),(0,s.j4)((0,n.SU)(v.PQ),{key:0,class:"spinner",name:"lines"})):((0,s.wg)(),(0,s.iD)("div",k,[(0,n.SU)(t)!==(0,n.SU)(h.g8).Trainer||N.value?((0,s.wg)(),(0,s.iD)(s.HY,{key:0},[(0,n.SU)(t)!==(0,n.SU)(h.g8).Manager&&(0,n.SU)(t)!==(0,n.SU)(h.g8).FacilityOwner&&(0,n.SU)(t)!==(0,n.SU)(h.g8).OrganizationOwner?((0,s.wg)(),(0,s.iD)("div",S,[(0,s.Wm)(i,{value:Z.value,loading:q.value,content:"Use my phone location",onChange:Q},null,8,["value","loading"])])):(0,s.kq)("",!0),(0,s._)("div",U,[(0,n.SU)(t)!==(0,n.SU)(h.g8).Manager&&(0,n.SU)(t)!==(0,n.SU)(h.g8).FacilityOwner&&(0,n.SU)(t)!==(0,n.SU)(h.g8).OrganizationOwner?((0,s.wg)(),(0,s.j4)((0,n.SU)(v.Q$),{key:0,class:"label"},{default:(0,s.w5)((()=>[(0,s.Uk)(" Location information ")])),_:1})):(0,s.kq)("",!0),(0,s._)("div",C,[(0,s.Wm)(u,{class:"address-content"},{default:(0,s.w5)((()=>[(0,s.Uk)(" Address ")])),_:1}),$.value?.thoroughfare?((0,s.wg)(),(0,s.j4)(u,{key:0,class:"address-content"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,o.zw)(`${$.value?.thoroughfare} ${$.value?.subThoroughfare}`)+", "+(0,o.zw)(`${$.value?.locality}`)+", "+(0,o.zw)(`${$.value?.administrativeArea}`)+", "+(0,o.zw)(`${$.value?.countryName}`),1)])),_:1})):(0,s.kq)("",!0)]),(0,s.Wm)(d,{placeholder:"Enter your address",class:(0,o.C_)(["search-form__control",{"search-form__control--on-focus":e.isFocused}]),onPlace_changed:J},null,8,["class"])]),(0,n.SU)(t)===(0,n.SU)(h.g8).Trainer?((0,s.wg)(),(0,s.iD)("div",T,[(0,s.Wm)((0,n.SU)(v.Q$),{class:"label"},{default:(0,s.w5)((()=>[(0,s.Uk)(" Please set your travel or distance radius (1-15 miles) ")])),_:1}),(0,s.Wm)(y.Z,{options:le,name:"radiusDistance"},{button:(0,s.w5)((()=>[(0,s.Wm)(g,{title:"Select radius",onHandleClick:a[0]||(a[0]=e=>ne("radiusDistance")),value:ee.value?`${ee.value} miles`:""},null,8,["value"])])),_:1})])):(0,s.kq)("",!0)],64)):((0,s.wg)(),(0,s.iD)(s.HY,{key:1},[(0,s._)("div",x,[(0,s.Wm)(g,{value:ce.value?.name??"",onHandleClick:ie,title:"Facility I work out of"},null,8,["value"])]),(0,s._)("div",A,[(0,s.Wm)(i,{value:ae.value,"onUpdate:value":a[1]||(a[1]=e=>ae.value=e),content:"Are you mobile"},null,8,["value"])]),(0,s._)("div",F,[(0,s.Wm)((0,n.SU)(v.Q$),{class:"label"},{default:(0,s.w5)((()=>[(0,s.Uk)(" Please set your travel or distance radius (1-15 miles) ")])),_:1}),(0,s.Wm)(y.Z,{options:le,name:"radiusDistance"},{button:(0,s.w5)((()=>[(0,s.Wm)(g,{title:"Select radius",onHandleClick:a[2]||(a[2]=e=>ne("radiusDistance")),value:ee.value?`${ee.value} miles`:""},null,8,["value"])])),_:1})])],64))]))])),footer:(0,s.w5)((()=>[(0,s.Wm)(c.Z,{"main-button-text":"Save",onClick:X,disabled:j.value||(0,n.SU)(I)},null,8,["disabled"])])),_:1}),(0,s.Wm)(m.Z,{ref_key:"chooseAddressModal",ref:W,onSelect:K},null,512)],64)}}}),L=t(83744);const W=(0,L.Z)(H,[["__scopeId","data-v-8fc491b8"]]);var M=W}}]);
//# sourceMappingURL=1867.03b44345.js.map