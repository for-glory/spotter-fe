{"version":3,"file":"js/1313.196ad102.js","mappings":"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","sources":["webpack://spotter/./src/hooks/useUser.ts","webpack://spotter/./src/general/components/blocks/footers/ButtonsFooter.vue?d623","webpack://spotter/./src/general/components/blocks/footers/ButtonsFooter.vue","webpack://spotter/./src/general/views/profile/Email.vue?36af","webpack://spotter/./src/general/views/profile/Email.vue"],"sourcesContent":["export default function useUser() {\n  const {first_name, last_name, email} = JSON.parse(localStorage.getItem(\"user\") || \"{}\");\n\n  return {\n    first_name, last_name, email\n  };\n}\n","import { defineComponent as _defineComponent } from 'vue'\nimport { toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, unref as _unref, withCtx as _withCtx, createVNode as _createVNode, openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, createElementBlock as _createElementBlock, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-70d0b6b0\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = { class: \"buttons__container\" }\n\nimport { IonButton } from \"@ionic/vue\";\nimport { withDefaults } from \"vue\";\n\n\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'ButtonsFooter',\n  props: {\n    mainButtonText: {},\n    secondaryButtonText: { default: \"\" },\n    disabled: { type: Boolean, default: false }\n  },\n  emits: [\"handle-click\", \"handle-secondary-click\"],\n  setup(__props: any) {\n\n\n\n\nreturn (_ctx: any,_cache: any) => {\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    _createVNode(_unref(IonButton), {\n      onClick: _cache[0] || (_cache[0] = ($event: any) => (_ctx.$emit('handle-click'))),\n      class: \"submit-btn\",\n      disabled: _ctx.disabled\n    }, {\n      default: _withCtx(() => [\n        _createTextVNode(_toDisplayString(_ctx.mainButtonText), 1)\n      ]),\n      _: 1\n    }, 8, [\"disabled\"]),\n    (_ctx.secondaryButtonText)\n      ? (_openBlock(), _createBlock(_unref(IonButton), {\n          key: 0,\n          class: \"secondary secondary-btn\",\n          onClick: _cache[1] || (_cache[1] = ($event: any) => (_ctx.$emit('handle-secondary-click')))\n        }, {\n          default: _withCtx(() => [\n            _createTextVNode(_toDisplayString(_ctx.secondaryButtonText), 1)\n          ]),\n          _: 1\n        }))\n      : _createCommentVNode(\"\", true)\n  ]))\n}\n}\n\n})","import script from \"./ButtonsFooter.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./ButtonsFooter.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./ButtonsFooter.vue?vue&type=style&index=0&id=70d0b6b0&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-70d0b6b0\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue'\nimport { createVNode as _createVNode, unref as _unref, isRef as _isRef, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, withCtx as _withCtx, openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, Transition as _Transition } from \"vue\"\n\nimport BaseLayout from \"@/general/components/base/BaseLayout.vue\";\nimport PageHeader from \"@/general/components/blocks/headers/PageHeader.vue\";\nimport BaseInput from \"@/general/components/base/BaseInput.vue\";\nimport ButtonsFooter from \"@/general/components/blocks/footers/ButtonsFooter.vue\";\nimport { useRouter } from \"vue-router\";\nimport { IonText } from \"@ionic/vue\";\nimport { useField } from \"vee-validate\";\nimport { emailSchema } from \"@/validations/authValidations\";\nimport { computed } from \"vue\";\nimport { humanizeString } from \"@/utils/textUtils\";\nimport { UpdateUserDocument } from \"@/generated/graphql\";\nimport { useMutation } from \"@vue/apollo-composable\";\nimport { clearAuthItems } from \"@/router/middleware/auth\";\nimport useId from \"@/hooks/useId\";\nimport useUser from \"@/hooks/useUser\";\nimport { EntitiesEnum } from \"@/const/entities\";\n\n\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'Email',\n  setup(__props) {\n\nconst router = useRouter();\n\nconst { id } = useId()\nconst { email } = useUser()\n\nconst { mutate, error, loading } = useMutation(UpdateUserDocument);\n\nlet { value: emailInput, errorMessage: emailInputError } = useField<string>(\n  \"email\",\n  emailSchema,\n  {\n    modelPropName: \"email\",\n  }\n);\n\nemailInput.value = email\n\nlet errorMessage = computed(() => {\n  return error.value ? humanizeString(error.value.message) : null;\n});\n\nconst isValidForm = computed(() => {\n  return !emailInputError.value && emailInput.value\n});\n\nconst onBack = () => {\n  router.go(-1);\n};\n\nconst changeInput = () => {\n  error.value = null\n}\n\nconst onSubmit = () => {\n  error.value = null\n  if (isValidForm.value) {\n    if(isValidForm.value != email){\n      \n      mutate({\n        id,\n        input: {\n          email: emailInput.value,\n        },\n      })\n        .then((result: any) => {\n          console.log(result, result.data, result.errors)\n          if(result.data !== undefined){\n            //cerrar sesion\n            clearAuthItems()\n            router.push({\n              name: EntitiesEnum.CheckEmail,\n            }); \n          } else if(result.errors){\n\n            //let error :any = result.errors\n            if(result.errors[0].extensions.validation == 'unique'){\n              console.log(\"aqui estab bn\")\n              error.value = result.errors[0]\n            }\n          }\n        })\n\n    }\n  }\n};\n\nreturn (_ctx: any,_cache: any) => {\n  return (_openBlock(), _createBlock(BaseLayout, null, {\n    header: _withCtx(() => [\n      _createVNode(PageHeader, {\n        \"back-btn\": \"\",\n        title: \"Change email\",\n        onBack: onBack\n      })\n    ]),\n    content: _withCtx(() => [\n      _createVNode(BaseInput, {\n        value: _unref(emailInput),\n        \"onUpdate:value\": _cache[0] || (_cache[0] = ($event: any) => (_isRef(emailInput) ? (emailInput).value = $event : emailInput = $event)),\n        \"error-message\": _unref(emailInputError),\n        type: \"email\",\n        disabled: _unref(loading),\n        onChange: changeInput,\n        placeholder: \"Enter new email\",\n        class: \"email-input\"\n      }, null, 8, [\"value\", \"error-message\", \"disabled\"]),\n      _createVNode(_Transition, {\n        name: \"fade\",\n        mode: \"out-in\",\n        duration: 500\n      }, {\n        default: _withCtx(() => [\n          (_unref(errorMessage))\n            ? (_openBlock(), _createBlock(_unref(IonText), {\n                key: 0,\n                class: \"error errormessaje\",\n                color: \"danger\"\n              }, {\n                default: _withCtx(() => [\n                  _createTextVNode(_toDisplayString(_unref(errorMessage)), 1)\n                ]),\n                _: 1\n              }))\n            : _createCommentVNode(\"\", true)\n        ]),\n        _: 1\n      })\n    ]),\n    footer: _withCtx(() => [\n      _createVNode(ButtonsFooter, {\n        \"main-button-text\": \"Change email\",\n        onClick: onSubmit,\n        disabled: !_unref(emailInput)\n      }, null, 8, [\"disabled\"])\n    ]),\n    _: 1\n  }))\n}\n}\n\n})","import script from \"./Email.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./Email.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./Email.vue?vue&type=style&index=0&id=284e591b&scoped=true&lang=scss\"\n\nimport exportComponent from \"../../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-284e591b\"]])\n\nexport default __exports__"],"names":["useUser","first_name","last_name","email","JSON","parse","localStorage","getItem","_hoisted_1","class","_defineComponent","__name","props","mainButtonText","secondaryButtonText","default","disabled","type","Boolean","emits","setup","__props","_ctx","_cache","_openBlock","_createElementBlock","_createVNode","_unref","IonButton","onClick","$event","$emit","_withCtx","_createTextVNode","_toDisplayString","_","_createBlock","key","_createCommentVNode","__exports__","router","useRouter","id","useId","mutate","error","loading","useMutation","UpdateUserDocument","value","emailInput","errorMessage","emailInputError","useField","emailSchema","modelPropName","computed","humanizeString","message","isValidForm","onBack","go","changeInput","onSubmit","input","then","result","console","log","data","errors","undefined","clearAuthItems","push","name","EntitiesEnum","CheckEmail","extensions","validation","BaseLayout","header","PageHeader","title","content","BaseInput","_isRef","onChange","placeholder","_Transition","mode","duration","IonText","color","footer","ButtonsFooter"],"sourceRoot":""}