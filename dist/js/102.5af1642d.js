"use strict";(self["webpackChunkspotter"]=self["webpackChunkspotter"]||[]).push([[102],{9189:function(n,e,a){a.d(e,{Z:function(){return r}});var s=a(87794),t=a(12712);function r(){const{role:n}=(0,t.Z)();if(n!==s.g8.Manager&&n!==s.g8.FacilityOwner&&n!==s.g8.OrganizationOwner)return{};const{facilities:e,owned_facilities:a}=JSON.parse(localStorage.getItem("user")||"{}"),r=n===s.g8.Manager?e[0]:a[0];return{id:r?.id}}},40102:function(n,e,a){a.r(e),a.d(e,{default:function(){return R}});a(57658);var s,t,r=a(66252),c=a(2262),i=a(10121),o=a(19239),_=a(22201),d=a(29895);(function(n){n["UPC_A"]="UPC_A",n["UPC_E"]="UPC_E",n["UPC_EAN_EXTENSION"]="UPC_EAN_EXTENSION",n["EAN_8"]="EAN_8",n["EAN_13"]="EAN_13",n["CODE_39"]="CODE_39",n["CODE_39_MOD_43"]="CODE_39_MOD_43",n["CODE_93"]="CODE_93",n["CODE_128"]="CODE_128",n["CODABAR"]="CODABAR",n["ITF"]="ITF",n["ITF_14"]="ITF_14",n["AZTEC"]="AZTEC",n["DATA_MATRIX"]="DATA_MATRIX",n["MAXICODE"]="MAXICODE",n["PDF_417"]="PDF_417",n["QR_CODE"]="QR_CODE",n["RSS_14"]="RSS_14",n["RSS_EXPANDED"]="RSS_EXPANDED"})(s||(s={})),function(n){n["FRONT"]="front",n["BACK"]="back"}(t||(t={}));const u=(0,d.fo)("BarcodeScanner",{web:()=>a.e(4640).then(a.bind(a,14640)).then((n=>new n.BarcodeScannerWeb))});var l=a(31810),g=a(81354),p=a.n(g),E=a(43173),h=a(49316),m=a(87794),f=a(61081),D=a(9189),A=a(12712);const C=n=>((0,r.dD)("data-v-0910a45e"),n=n(),(0,r.Cn)(),n),S={key:0,class:"scanner"},v=C((()=>(0,r._)("span",{class:"scanner__corner scanner__corner--tl"},null,-1))),w=C((()=>(0,r._)("span",{class:"scanner__corner scanner__corner--tr"},null,-1))),y=C((()=>(0,r._)("span",{class:"scanner__corner scanner__corner--br"},null,-1))),N=C((()=>(0,r._)("span",{class:"scanner__corner scanner__corner--bl"},null,-1))),O=C((()=>(0,r._)("span",{class:"scanner__scan"},null,-1))),T={class:"scanner__hint"},b=C((()=>(0,r._)("span",{class:"scanner__hint__text"}," Scan the cleintâ€™s QR-code. The code should be in the center of scanner. ",-1)));var k=(0,r.aZ)({__name:"Scan",setup(n){const e=(0,_.tv)(),a=()=>{e.go(-1)},s=(0,c.iH)(!0);(0,r.bv)((()=>{d()})),(0,r.Ah)((()=>{C()}));const t=()=>new Promise(((n,e)=>{u.checkPermission({force:!0}).then((a=>{a.granted?n(!0):a.denied&&(u.openAppSettings(),e(!1))})).catch((n=>{console.log("check permission error: ",n)}))})),d=async()=>{const n=await t();if(n){s.value=!0,u.hideBackground(),document.body.classList.add("bg-transparent");const n=await u.startScan();if(n.hasContent&&n.content){s.value=!1;const{id:a}=(0,E.Z)(),{role:t}=(0,A.Z)(),{id:r}=(0,D.Z)(),c=p().AES.decrypt(n.content,t===m.g8.Trainer?a:r).toString(p().enc.Utf8).split("/");switch(c[0]){case"facilityPass":return P(m.kX,{id:c[1]});case"training":return X(m.BE,{id:c[1]});case"event":return e.push({name:f.N.Session,params:{id:c[1]},query:{userId:c[2],type:f.N.Event}});default:g("Nothing found!","warning-toast"),d();break}}else d()}else g("Permission not allowed!","warning-toast"),a()},g=async(n,e)=>{const a=await l.Mn.create({message:n,cssClass:e,duration:2e3,icon:"assets/icon/info.svg"});a.present()},C=()=>{document.body.classList.remove("bg-transparent"),u.stopScan(),s.value=!1},{onResult:k,load:P,onError:I}=(0,h.td)(m.kX);I((()=>{d()}));const{mutate:R,onDone:Z,onError:B}=(0,h.Db)(m.Yc);k((n=>{const e=n.data.facilityItemPass;if(!e?.is_active_pass)return g("This GYM pass is not active","warning-toast");const{id:a}=(0,E.Z)(),s={input:{facility_item_pass_id:e.id,manager_id:a}};R(s)})),B((n=>{g(n.message,"danger-toast")})),Z((n=>{g(`${n.data.checkinByPass.user.first_name} ${n.data.checkinByPass.user.last_name} successfully checked in`,"success-toast"),e.push({name:f.N.Session,params:{id:n.data.checkinByPass.id},query:{type:f.N.Facility}})}));const{onResult:M,load:X,onError:F}=(0,h.td)(m.BE);F((()=>{d()}));const{mutate:U,onDone:q,onError:$}=(0,h.Db)(m.Lx);return M((n=>{const a=n.data.training;if(a.state!==m.Z3.Accepted)return a.state===m.Z3.Started?e.push({name:f.N.Session,params:{id:a.id},query:{type:f.N.Training}}):g(`Error! Training status is ${a.state}`,"warning-toast");const s={input:{training_id:a.id,user_id:a.user.id}};U(s)})),$((n=>{g(n.message,"danger-toast")})),q((n=>{g(`Training with ${n.data.training.user.first_name} ${n.data.training.user.last_name} was started`,"success-toast"),e.push({name:f.N.Session,params:{id:n.data.training.id},query:{type:f.N.Training}})})),(n,e)=>((0,r.wg)(),(0,r.j4)(i.Z,{"hide-navigation-menu":""},{header:(0,r.w5)((()=>[(0,r.Wm)(o.Z,{class:"header",title:"Scan code","back-btn":"",onBack:a,transparent:""})])),content:(0,r.w5)((()=>[s.value?((0,r.wg)(),(0,r.iD)("div",S,[v,w,y,N,O,(0,r._)("div",T,[(0,r.Wm)((0,c.SU)(l.gu),{class:"scanner__hint__icon",src:"assets/icon/scanner.svg"}),b])])):(0,r.kq)("",!0)])),_:1}))}}),P=a(83744);const I=(0,P.Z)(k,[["__scopeId","data-v-0910a45e"]]);var R=I}}]);
//# sourceMappingURL=102.5af1642d.js.map