{"version":3,"file":"js/2717.bc82a2fc.js","mappings":"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","sources":["webpack://spotter/./src/users/views/dashboards/Index.vue?1cad","webpack://spotter/./src/users/views/dashboards/Index.vue"],"sourcesContent":["import { defineComponent as _defineComponent } from 'vue'\nimport { unref as _unref, createVNode as _createVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, withCtx as _withCtx, createTextVNode as _createTextVNode, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, renderList as _renderList, Fragment as _Fragment, createBlock as _createBlock, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-464dc8d1\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = {\n  key: 0,\n  class: \"header-btn__badge\"\n}\nconst _hoisted_2 = { class: \"dashboard\" }\nconst _hoisted_3 = { class: \"dashboards-items\" }\nconst _hoisted_4 = { class: \"rating__container\" }\nconst _hoisted_5 = { class: \"events__container\" }\n\nimport BaseLayout from \"@/general/components/base/BaseLayout.vue\";\nimport PageHeader from \"@/general/components/blocks/headers/PageHeader.vue\";\nimport DashboardItem from \"@/general/components/DashboardItem.vue\";\nimport { IonButton, IonIcon, IonText, IonSpinner } from \"@ionic/vue\";\nimport { TabItem } from \"@/interfaces/TabItem\";\nimport { EntitiesEnum } from \"@/const/entities\";\nimport { computed, onMounted, ref } from \"vue\";\nimport PageTabs from \"@/general/components/PageTabs.vue\";\nimport {\n  EventPaginator,\n  MyEventsDocument,\n  MyFacilityItemPassesDocument,\n  FacilityItemPass,\n  UserPaginator,\n  MyTrainingsDocument,\n  DashboardWidgetDocument,\n  UserAvailabilityDocument,\n  Training,\n  QueryMyTrainingsOrderByColumn,\n  SortOrder,\n  QueryMyFacilityItemPassesOrderByColumn,\n  QueryMyEventsOrderByColumn,\n  TrainingStatesEnum,\n} from \"@/generated/graphql\";\nimport { useQuery } from \"@vue/apollo-composable\";\nimport EventItem from \"@/general/components/EventItem.vue\";\nimport ItemsHeader from \"@/general/components/blocks/headers/ItemsHeader.vue\";\nimport WeekCalendar from \"@/general/components/blocks/calendar/WeekCalendar.vue\";\nimport dayjs, { Dayjs } from \"dayjs\";\nimport { useRouter } from \"vue-router\";\nimport useId from \"@/hooks/useId\";\nimport { onValue } from \"firebase/database\";\nimport { chatsRef } from \"@/firebase/db\";\nimport EmptyBlock from \"@/general/components/EmptyBlock.vue\";\n\n\nconst __default__ = {\n  name: \"Dashboard\",\n};\n\nexport default /*#__PURE__*/_defineComponent({\n  ...__default__,\n  setup(__props) {\n\nconst router = useRouter();\nconst { id } = useId();\nconst unreadMessages = ref<number[]>([]);\n\nconst {\n  result: eventsResult,\n  loading: isEventsLoading,\n  refetch: refetchEvents,\n} = useQuery(\n  MyEventsDocument,\n  {\n    page: 1,\n    first: 4,\n    start_date: {\n      from: dayjs().format(\"YYYY-MM-DD HH:mm:ss\"),\n      to: dayjs().add(1, \"M\").format(\"YYYY-MM-DD HH:mm:ss\"),\n    },\n    orderBy: [\n      {\n        column: QueryMyEventsOrderByColumn.StartDate,\n        order: SortOrder.Asc,\n      },\n    ],\n  },\n  {\n    fetchPolicy: \"no-cache\",\n  }\n);\n\nconst {\n  result: trainingsResult,\n  loading: isTrainingsLoading,\n  refetch: refetchTrainings,\n} = useQuery(\n  MyTrainingsDocument,\n  {\n    page: 1,\n    first: 4,\n    start_date: {\n      from: dayjs().format(\"YYYY-MM-DD HH:mm:ss\"),\n      to: dayjs().add(1, \"M\").format(\"YYYY-MM-DD HH:mm:ss\"),\n    },\n    orderBy: [\n      {\n        column: QueryMyTrainingsOrderByColumn.StartDate,\n        order: SortOrder.Asc,\n      },\n    ],\n  },\n  {\n    fetchPolicy: \"no-cache\",\n  }\n);\n\nconst {\n  result: facilitiesResult,\n  loading: isFacilitiesLoading,\n  refetch: refetchFacilities,\n} = useQuery(\n  MyFacilityItemPassesDocument,\n  {\n    page: 1,\n    first: 4,\n    orderBy: [\n      {\n        column: QueryMyFacilityItemPassesOrderByColumn.StartDate,\n        order: SortOrder.Asc,\n      },\n    ],\n  },\n  {\n    fetchPolicy: \"no-cache\",\n  }\n);\n\n// Dashboard widgets - Activity + My Ratings widgets info\nconst { result: dashboardWidgetResult } = useQuery(DashboardWidgetDocument);\n\n// Calendar info\nconst { result: calendarWidgetResult } = useQuery(\n  UserAvailabilityDocument,\n  {\n    id,\n    from: dayjs().startOf(\"d\").format(\"YYYY-MM-DD HH:mm:ss\"),\n    to: dayjs().day(6).endOf(\"d\").format(\"YYYY-MM-DD HH:mm:ss\"),\n  },\n  {\n    fetchPolicy: \"no-cache\",\n  }\n);\n\nconst bookings = computed(() => {\n  const availability = [];\n  if (calendarWidgetResult && calendarWidgetResult?.value) {\n    const userAvailability = calendarWidgetResult?.value?.userAvailability;\n\n    if (userAvailability && userAvailability?.events) {\n      const { events } = userAvailability;\n      const bookedEvents = events.map((event: any) => ({\n        start_date: event?.start_date || null,\n      }));\n\n      availability.push(...bookedEvents);\n    }\n    if (userAvailability && userAvailability?.trainings) {\n      const { trainings } = userAvailability;\n      const bookedTrainings = trainings\n        .filter(\n          (training: Training) => training.state === TrainingStatesEnum.Accepted\n        )\n        .map((training: Training) => ({\n          start_date: training?.start_date || null,\n        }));\n      availability.push(...bookedTrainings);\n    }\n  }\n  return availability;\n});\n\nconst fetchChats = () => {\n  if (unreadMessages.value.length) unreadMessages.value = [];\n  onValue(chatsRef, (snapshot) => {\n    snapshot.forEach((childSnapshot) => {\n      const chat = childSnapshot.val();\n      if (chat.unread && chat.unread[id]) {\n        unreadMessages.value.push(chat.unread[id]);\n      }\n    });\n  });\n};\n\nonMounted(() => {\n  fetchChats();\n});\n\nconst widgetInfo = computed(() => dashboardWidgetResult?.value?.me || []);\n\nconst ratingItems = computed(() => [\n  {\n    value: widgetInfo?.value?.reviews_count || 0,\n    description: \"total feedbacks\",\n  },\n]);\n\nconst activityItems = computed(() => [\n  {\n    value: widgetInfo?.value?.checkins_count || 0,\n    description: \"gym check-ins\",\n  },\n  {\n    value: widgetInfo?.value?.completed_trainings_count || 0,\n    description: \"trainings done\",\n  },\n]);\n\nconst events = computed<EventPaginator[\"data\"]>(() =>\n  eventsResult?.value?.myEvents?.data ? eventsResult.value.myEvents.data : []\n);\n\nconst trainings = computed(() =>\n  trainingsResult?.value?.myTrainings?.data\n    ? trainingsResult.value.myTrainings.data.map((training: Training) => ({\n        ...training,\n        title: `${training.trainer.first_name} ${training.trainer.last_name}`,\n        address: training.trainer.address,\n        media: [{ pathUrl: training.trainer.avatarUrl }],\n      }))\n    : []\n);\n\nconst facilities = computed<UserPaginator[\"data\"]>(() =>\n  facilitiesResult?.value?.myFacilityItemPasses?.data\n    ? facilitiesResult.value.myFacilityItemPasses.data.map(\n        (facilityPass: FacilityItemPass) => ({\n          id: facilityPass.id,\n          title: facilityPass.facilityItem.facility.name,\n          end_date: facilityPass.end_date,\n          start_date: dayjs(facilityPass.end_date)\n            .subtract(\n              facilityPass.facilityItem.qr_code_lifetime_value ?? 0,\n              \"d\"\n            )\n            .format(\"YYYY-MM-DD HH:mm:ss\"),\n          media: facilityPass.facilityItem.facility.media,\n          address: facilityPass.facilityItem.facility.address,\n        })\n      )\n    : []\n);\n\nconst selectedEvents = computed(() => {\n  if (activeTab.value === EntitiesEnum.Events) {\n    return events.value;\n  }\n\n  if (activeTab.value === EntitiesEnum.Facilities) {\n    return facilities.value;\n  }\n\n  return trainings.value;\n});\n\nconst bookingName = computed(() => {\n  if (activeTab.value === EntitiesEnum.Events) {\n    return \"events\";\n  }\n\n  if (activeTab.value === EntitiesEnum.Facilities) {\n    return \"gyms\";\n  }\n\n  return \"trainings\";\n});\n\nconst tabs: TabItem[] = [\n  {\n    name: EntitiesEnum.Facilities,\n    label: \"Gyms\",\n  },\n  {\n    name: EntitiesEnum.Trainings,\n    label: \"Trainings\",\n  },\n  {\n    name: EntitiesEnum.Events,\n    label: \"Events\",\n  },\n];\n\nconst selectedDate = ref<Dayjs | null>(dayjs());\n\nconst activeTab = ref<EntitiesEnum>(\n  (localStorage.getItem(\"dashboard_active_tab\") as EntitiesEnum) ||\n    EntitiesEnum.Facilities\n);\n\nconst tabsChanged = (ev: EntitiesEnum) => {\n  if (!ev) return;\n  activeTab.value = ev;\n  localStorage.setItem(\"dashboard_active_tab\", activeTab.value);\n  refetchBooking();\n};\n\nconst refetchBooking = () => {\n  switch (activeTab.value) {\n    case EntitiesEnum.Events:\n      refetchEvents();\n      break;\n\n    case EntitiesEnum.Trainings:\n      refetchTrainings();\n      break;\n\n    case EntitiesEnum.Facilities:\n      refetchFacilities();\n      break;\n\n    default:\n      break;\n  }\n};\n\nconst onViewAllEvents = () => {\n  router.push({ name: EntitiesEnum.DashboardEvents });\n};\n\nconst onViewChat = () => {\n  router.push({ name: EntitiesEnum.ChatList });\n};\nconst onViewFavourites = () => {\n  router.push({ name: EntitiesEnum.Favourites });\n};\n\nconst onViewCalendar = () => {\n  router.push({ name: EntitiesEnum.DashboardCalendar });\n};\n\nconst openEvent = (id: string | number) => {\n  switch (activeTab.value) {\n    case EntitiesEnum.Facilities:\n      return router.push({\n        name: EntitiesEnum.BookedTraining,\n        params: { id },\n        query: {\n          type: EntitiesEnum.Facility,\n        },\n      });\n\n    case EntitiesEnum.Trainings:\n      return router.push({\n        name: EntitiesEnum.BookedTraining,\n        params: { id },\n        query: {\n          type: EntitiesEnum.Training,\n        },\n      });\n\n    case EntitiesEnum.Events:\n      return router.push({\n        name: EntitiesEnum.BookedTraining,\n        params: { id },\n        query: {\n          type: EntitiesEnum.Event,\n        },\n      });\n\n    default:\n      break;\n  }\n};\n\nreturn (_ctx: any,_cache: any) => {\n  return (_openBlock(), _createBlock(BaseLayout, null, {\n    header: _withCtx(() => [\n      _createVNode(PageHeader, { title: \"My Dashboard\" }, {\n        \"custom-btn\": _withCtx(() => [\n          _createVNode(_unref(IonButton), {\n            onClick: onViewChat,\n            class: \"header-btn\"\n          }, {\n            default: _withCtx(() => [\n              _createVNode(_unref(IonIcon), { src: \"assets/icon/chat.svg\" }),\n              (unreadMessages.value.length)\n                ? (_openBlock(), _createElementBlock(\"span\", _hoisted_1))\n                : _createCommentVNode(\"\", true)\n            ]),\n            _: 1\n          }),\n          _createVNode(_unref(IonButton), {\n            onClick: onViewFavourites,\n            class: \"header-btn\"\n          }, {\n            default: _withCtx(() => [\n              _createVNode(_unref(IonIcon), { src: \"assets/icon/heart.svg\" })\n            ]),\n            _: 1\n          })\n        ]),\n        _: 1\n      })\n    ]),\n    content: _withCtx(() => [\n      _createElementVNode(\"div\", _hoisted_2, [\n        _createElementVNode(\"div\", _hoisted_3, [\n          _createVNode(DashboardItem, { items: activityItems.value }, {\n            title: _withCtx(() => [\n              _createVNode(_unref(IonIcon), {\n                src: \"assets/icon/activity.svg\",\n                class: \"activity-icon\"\n              }),\n              _createTextVNode(\" Activity \")\n            ]),\n            _: 1\n          }, 8, [\"items\"]),\n          _createVNode(DashboardItem, { items: ratingItems.value }, {\n            title: _withCtx(() => [\n              _createVNode(_unref(IonIcon), {\n                src: \"assets/icon/trophy.svg\",\n                class: \"trophy-icon\"\n              }),\n              _createTextVNode(\" My Ratings \")\n            ]),\n            bottom: _withCtx(() => [\n              _createElementVNode(\"div\", _hoisted_4, [\n                _createVNode(_unref(IonText), { class: \"rating-likes\" }, {\n                  default: _withCtx(() => [\n                    _createTextVNode(_toDisplayString(widgetInfo.value?.positive_reviews_count || 0) + \" \", 1),\n                    _createVNode(_unref(IonIcon), {\n                      class: \"like-icon\",\n                      src: \"assets/icon/like.svg\"\n                    })\n                  ]),\n                  _: 1\n                }),\n                _createVNode(_unref(IonText), { class: \"rating-dislikes\" }, {\n                  default: _withCtx(() => [\n                    _createTextVNode(_toDisplayString(widgetInfo.value?.negative_reviews_count || 0) + \" \", 1),\n                    _createVNode(_unref(IonIcon), {\n                      class: \"dislike-icon\",\n                      src: \"assets/icon/dislike.svg\"\n                    })\n                  ]),\n                  _: 1\n                })\n              ])\n            ]),\n            _: 1\n          }, 8, [\"items\"])\n        ]),\n        _createVNode(WeekCalendar, {\n          modelValue: selectedDate.value,\n          \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event: any) => ((selectedDate).value = $event)),\n          bookings: bookings.value,\n          onHandleView: onViewCalendar\n        }, null, 8, [\"modelValue\", \"bookings\"]),\n        _createElementVNode(\"div\", _hoisted_5, [\n          _createVNode(ItemsHeader, {\n            title: \"Upcoming bookings\",\n            onHandleView: onViewAllEvents,\n            \"hide-view-more\": \n              !selectedEvents.value?.length ||\n              _unref(isFacilitiesLoading) ||\n              _unref(isTrainingsLoading) ||\n              _unref(isEventsLoading)\n            \n          }, null, 8, [\"hide-view-more\"]),\n          (\n              selectedEvents.value.length &&\n              !_unref(isTrainingsLoading) &&\n              !_unref(isEventsLoading) &&\n              !_unref(isFacilitiesLoading)\n            )\n            ? (_openBlock(true), _createElementBlock(_Fragment, { key: 0 }, _renderList(selectedEvents.value, (event) => {\n                return (_openBlock(), _createBlock(EventItem, {\n                  key: event.id,\n                  item: event,\n                  rounded: activeTab.value === _unref(EntitiesEnum).Trainings,\n                  \"date-range\": activeTab.value === _unref(EntitiesEnum).Facilities,\n                  onClick: ($event: any) => (openEvent(event.id))\n                }, null, 8, [\"item\", \"rounded\", \"date-range\", \"onClick\"]))\n              }), 128))\n            : (\n              _unref(isTrainingsLoading) || _unref(isEventsLoading) || _unref(isFacilitiesLoading)\n            )\n              ? (_openBlock(), _createBlock(_unref(IonSpinner), {\n                  key: 1,\n                  name: \"lines\",\n                  class: \"spinner\"\n                }))\n              : (_openBlock(), _createBlock(EmptyBlock, {\n                  key: 2,\n                  \"hide-button\": \"\",\n                  icon: \"assets/icon/empty.svg\",\n                  title: `Sorry, no ${bookingName.value} found`,\n                  text: `Currently you have no booked ${bookingName.value}`\n                }, null, 8, [\"title\", \"text\"]))\n        ]),\n        _createVNode(PageTabs, {\n          tabs: tabs,\n          class: \"page-tabs\",\n          value: activeTab.value,\n          onChange: tabsChanged\n        }, null, 8, [\"value\"])\n      ])\n    ]),\n    _: 1\n  }))\n}\n}\n\n})","import script from \"./Index.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./Index.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./Index.vue?vue&type=style&index=0&id=464dc8d1&scoped=true&lang=scss\"\n\nimport exportComponent from \"../../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-464dc8d1\"]])\n\nexport default __exports__"],"names":["_hoisted_1","key","class","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_5","__default__","name","_defineComponent","setup","__props","router","useRouter","id","useId","unreadMessages","ref","result","eventsResult","loading","isEventsLoading","refetch","refetchEvents","useQuery","MyEventsDocument","page","first","start_date","from","dayjs","format","to","add","orderBy","column","QueryMyEventsOrderByColumn","StartDate","order","SortOrder","Asc","fetchPolicy","trainingsResult","isTrainingsLoading","refetchTrainings","MyTrainingsDocument","QueryMyTrainingsOrderByColumn","facilitiesResult","isFacilitiesLoading","refetchFacilities","MyFacilityItemPassesDocument","QueryMyFacilityItemPassesOrderByColumn","dashboardWidgetResult","DashboardWidgetDocument","calendarWidgetResult","UserAvailabilityDocument","startOf","day","endOf","bookings","computed","availability","value","userAvailability","events","bookedEvents","map","event","push","trainings","bookedTrainings","filter","training","state","TrainingStatesEnum","Accepted","fetchChats","length","onValue","chatsRef","snapshot","forEach","childSnapshot","chat","val","unread","onMounted","widgetInfo","me","ratingItems","reviews_count","description","activityItems","checkins_count","completed_trainings_count","myEvents","data","myTrainings","title","trainer","first_name","last_name","address","media","pathUrl","avatarUrl","facilities","myFacilityItemPasses","facilityPass","facilityItem","facility","end_date","subtract","qr_code_lifetime_value","selectedEvents","activeTab","EntitiesEnum","Events","Facilities","bookingName","tabs","label","Trainings","selectedDate","localStorage","getItem","tabsChanged","ev","setItem","refetchBooking","onViewAllEvents","DashboardEvents","onViewChat","ChatList","onViewFavourites","Favourites","onViewCalendar","DashboardCalendar","openEvent","BookedTraining","params","query","type","Facility","Training","Event","_ctx","_cache","_openBlock","_createBlock","BaseLayout","header","_withCtx","_createVNode","PageHeader","_unref","IonButton","onClick","default","IonIcon","src","_createElementBlock","_createCommentVNode","_","content","_createElementVNode","DashboardItem","items","_createTextVNode","bottom","IonText","_toDisplayString","positive_reviews_count","negative_reviews_count","WeekCalendar","modelValue","$event","onHandleView","ItemsHeader","IonSpinner","EmptyBlock","icon","text","_Fragment","_renderList","EventItem","item","rounded","PageTabs","onChange","__exports__"],"sourceRoot":""}